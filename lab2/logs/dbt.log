[0m12:53:22.758627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C0BF4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1F23ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1F23B10>]}


============================== 12:53:22.762668 | 78d06e65-ccfa-4a0f-8b21-d0a6e9b75706 ==============================
[0m12:53:22.762668 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:53:22.763372 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:53:22.940314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d06e65-ccfa-4a0f-8b21-d0a6e9b75706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C122D940>]}
[0m12:53:22.959182 [debug] [MainThread]: Set downloads directory='C:\Users\MSI\AppData\Local\Temp\dbt-downloads-0zv6q04o'
[0m12:53:22.959679 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:53:23.680796 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:53:23.682135 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:53:24.079321 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:53:24.093942 [info ] [MainThread]: Updating lock file in file path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2/package-lock.yml
[0m12:53:24.107248 [debug] [MainThread]: Set downloads directory='C:\Users\MSI\AppData\Local\Temp\dbt-downloads-tbopemoo'
[0m12:53:24.110632 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:53:25.491488 [info ] [MainThread]: Installed from version 1.1.1
[0m12:53:25.492180 [info ] [MainThread]: Updated version available: 1.3.3
[0m12:53:25.492670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '78d06e65-ccfa-4a0f-8b21-d0a6e9b75706', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C3603130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C3600E20>]}
[0m12:53:25.493049 [info ] [MainThread]: 
[0m12:53:25.493472 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m12:53:25.494990 [debug] [MainThread]: Command `dbt deps` succeeded at 12:53:25.494862 after 2.94 seconds
[0m12:53:25.495343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C35EB350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C1DABF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5C0B606E0>]}
[0m12:53:25.495727 [debug] [MainThread]: Flushing usage events
[0m12:53:26.502264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:37.093881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B811F24C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B813257ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B813257B10>]}


============================== 12:53:37.098093 | a27e427e-1565-4f35-8c36-f8ef8d9a3723 ==============================
[0m12:53:37.098093 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:53:37.098770 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:53:37.112180 [info ] [MainThread]: dbt version: 1.11.6
[0m12:53:37.112732 [info ] [MainThread]: python version: 3.13.12
[0m12:53:37.113295 [info ] [MainThread]: python path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\.venv\Scripts\python.exe
[0m12:53:37.113921 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:53:37.223139 [info ] [MainThread]: Using profiles dir at .
[0m12:53:37.223707 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m12:53:37.224193 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\dbt_project.yml
[0m12:53:37.226268 [info ] [MainThread]: adapter type: duckdb
[0m12:53:37.226729 [info ] [MainThread]: adapter version: 1.10.1
[0m12:53:37.343262 [info ] [MainThread]: Configuration:
[0m12:53:37.343894 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:53:37.344415 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:53:37.344874 [info ] [MainThread]: Required dependencies:
[0m12:53:37.345367 [debug] [MainThread]: Executing "git --help"
[0m12:53:37.350136 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:53:37.350594 [info ] [MainThread]: Connection:
[0m12:53:37.351148 [info ] [MainThread]:   database: google_play
[0m12:53:37.351842 [info ] [MainThread]:   schema: main
[0m12:53:37.352389 [info ] [MainThread]:   path: data/google_play.duckdb
[0m12:53:37.353044 [info ] [MainThread]:   config_options: None
[0m12:53:37.353592 [info ] [MainThread]:   extensions: None
[0m12:53:37.354052 [info ] [MainThread]:   settings: {}
[0m12:53:37.354533 [info ] [MainThread]:   external_root: .
[0m12:53:37.354983 [info ] [MainThread]:   use_credential_provider: None
[0m12:53:37.355479 [info ] [MainThread]:   attach: None
[0m12:53:37.356036 [info ] [MainThread]:   filesystems: None
[0m12:53:37.356596 [info ] [MainThread]:   remote: None
[0m12:53:37.357066 [info ] [MainThread]:   plugins: None
[0m12:53:37.357620 [info ] [MainThread]:   disable_transactions: False
[0m12:53:37.358270 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:53:37.579308 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:53:37.636648 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:53:37.637053 [debug] [MainThread]: On debug: select 1 as id
[0m12:53:37.637332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:37.645703 [debug] [MainThread]: DuckDB adapter: duckdb error: IO Error: The file "c:\users\msi\downloads\data-enginering-main\data-enginering-main\lab2\data\google_play.duckdb" exists, but it is not a valid DuckDB database file!
[0m12:53:37.646138 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m12:53:37.646468 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m12:53:37.646740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:37.652109 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:53:37.652709 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:53:37.653215 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:53:37.653959 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >IO Error: The file "c:\users\msi\downloads\data-enginering-main\data-enginering-main\lab2\data\google_play.duckdb" exists, but it is not a valid DuckDB database file!

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:53:37.655044 [debug] [MainThread]: Command `dbt debug` failed at 12:53:37.654928 after 0.71 seconds
[0m12:53:37.655357 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:53:37.655665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B814919940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B814A0C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8142C38A0>]}
[0m12:53:37.656027 [debug] [MainThread]: Flushing usage events
[0m12:53:38.404271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:43.224175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAB364C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAC697ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAC697B10>]}


============================== 12:54:43.228482 | ebefbc25-89d3-47e1-9be9-810e16688ade ==============================
[0m12:54:43.228482 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:54:43.229091 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:54:43.242229 [info ] [MainThread]: dbt version: 1.11.6
[0m12:54:43.242756 [info ] [MainThread]: python version: 3.13.12
[0m12:54:43.243305 [info ] [MainThread]: python path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\.venv\Scripts\python.exe
[0m12:54:43.243762 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:54:43.355776 [info ] [MainThread]: Using profiles dir at .
[0m12:54:43.356306 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m12:54:43.356705 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\dbt_project.yml
[0m12:54:43.358772 [info ] [MainThread]: adapter type: duckdb
[0m12:54:43.359210 [info ] [MainThread]: adapter version: 1.10.1
[0m12:54:43.472160 [info ] [MainThread]: Configuration:
[0m12:54:43.472763 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:54:43.473240 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:54:43.473659 [info ] [MainThread]: Required dependencies:
[0m12:54:43.474117 [debug] [MainThread]: Executing "git --help"
[0m12:54:43.478898 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:54:43.479366 [info ] [MainThread]: Connection:
[0m12:54:43.479869 [info ] [MainThread]:   database: google_play
[0m12:54:43.480350 [info ] [MainThread]:   schema: main
[0m12:54:43.480770 [info ] [MainThread]:   path: data/google_play.duckdb
[0m12:54:43.481232 [info ] [MainThread]:   config_options: None
[0m12:54:43.481653 [info ] [MainThread]:   extensions: None
[0m12:54:43.482064 [info ] [MainThread]:   settings: {}
[0m12:54:43.482482 [info ] [MainThread]:   external_root: .
[0m12:54:43.482906 [info ] [MainThread]:   use_credential_provider: None
[0m12:54:43.483313 [info ] [MainThread]:   attach: None
[0m12:54:43.483669 [info ] [MainThread]:   filesystems: None
[0m12:54:43.484073 [info ] [MainThread]:   remote: None
[0m12:54:43.484474 [info ] [MainThread]:   plugins: None
[0m12:54:43.484887 [info ] [MainThread]:   disable_transactions: False
[0m12:54:43.485497 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:54:43.704274 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:54:43.763343 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:54:43.763690 [debug] [MainThread]: On debug: select 1 as id
[0m12:54:43.763960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:43.781466 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m12:54:43.782435 [debug] [MainThread]: On debug: Close
[0m12:54:43.782766 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:54:43.783235 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:54:43.783685 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:54:43.784618 [debug] [MainThread]: Command `dbt debug` failed at 12:54:43.784506 after 0.74 seconds
[0m12:54:43.784926 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:54:43.785251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FADD09940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FADDFC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021FAC7338A0>]}
[0m12:54:43.785637 [debug] [MainThread]: Flushing usage events
[0m12:54:44.686523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:19.901030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022637C64C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638F9FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022638F9FB10>]}


============================== 12:55:19.904989 | 129e7449-a384-458b-ac40-9b3833640438 ==============================
[0m12:55:19.904989 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:55:19.905629 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:55:19.918745 [info ] [MainThread]: dbt version: 1.11.6
[0m12:55:19.919221 [info ] [MainThread]: python version: 3.13.12
[0m12:55:19.919671 [info ] [MainThread]: python path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\.venv\Scripts\python.exe
[0m12:55:19.920277 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:55:20.029563 [info ] [MainThread]: Using profiles dir at .
[0m12:55:20.030147 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m12:55:20.030607 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\dbt_project.yml
[0m12:55:20.032670 [info ] [MainThread]: adapter type: duckdb
[0m12:55:20.033132 [info ] [MainThread]: adapter version: 1.10.1
[0m12:55:20.143648 [info ] [MainThread]: Configuration:
[0m12:55:20.144212 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:55:20.144692 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:55:20.145144 [info ] [MainThread]: Required dependencies:
[0m12:55:20.145600 [debug] [MainThread]: Executing "git --help"
[0m12:55:20.150725 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:55:20.151180 [info ] [MainThread]: Connection:
[0m12:55:20.151685 [info ] [MainThread]:   database: google_play
[0m12:55:20.152242 [info ] [MainThread]:   schema: main
[0m12:55:20.152698 [info ] [MainThread]:   path: data/google_play.duckdb
[0m12:55:20.153173 [info ] [MainThread]:   config_options: None
[0m12:55:20.153629 [info ] [MainThread]:   extensions: None
[0m12:55:20.154099 [info ] [MainThread]:   settings: {}
[0m12:55:20.154587 [info ] [MainThread]:   external_root: .
[0m12:55:20.155103 [info ] [MainThread]:   use_credential_provider: None
[0m12:55:20.155585 [info ] [MainThread]:   attach: None
[0m12:55:20.156030 [info ] [MainThread]:   filesystems: None
[0m12:55:20.156462 [info ] [MainThread]:   remote: None
[0m12:55:20.156891 [info ] [MainThread]:   plugins: None
[0m12:55:20.157416 [info ] [MainThread]:   disable_transactions: False
[0m12:55:20.158135 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:55:20.377754 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:55:20.435173 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:55:20.435545 [debug] [MainThread]: On debug: select 1 as id
[0m12:55:20.435845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:20.458401 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m12:55:20.459288 [debug] [MainThread]: On debug: Close
[0m12:55:20.459595 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:55:20.460076 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:55:20.460519 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:55:20.461370 [debug] [MainThread]: Command `dbt debug` failed at 12:55:20.461265 after 0.70 seconds
[0m12:55:20.461661 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:55:20.461968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A649A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263A73C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226390338A0>]}
[0m12:55:20.462317 [debug] [MainThread]: Flushing usage events
[0m12:55:21.305973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:55:28.831460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AB484C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AC7BFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AC7BFB10>]}


============================== 12:55:28.835290 | faba3fde-b48e-4a09-a261-cba09e990896 ==============================
[0m12:55:28.835290 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:55:28.835879 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:55:28.848768 [info ] [MainThread]: dbt version: 1.11.6
[0m12:55:28.849268 [info ] [MainThread]: python version: 3.13.12
[0m12:55:28.849886 [info ] [MainThread]: python path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\.venv\Scripts\python.exe
[0m12:55:28.850535 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:55:28.956223 [info ] [MainThread]: Using profiles dir at .
[0m12:55:28.956748 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m12:55:28.957147 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\dbt_project.yml
[0m12:55:28.959077 [info ] [MainThread]: adapter type: duckdb
[0m12:55:28.959495 [info ] [MainThread]: adapter version: 1.10.1
[0m12:55:29.063998 [info ] [MainThread]: Configuration:
[0m12:55:29.064590 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:55:29.065069 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:55:29.065557 [info ] [MainThread]: Required dependencies:
[0m12:55:29.066059 [debug] [MainThread]: Executing "git --help"
[0m12:55:29.070939 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:55:29.071405 [info ] [MainThread]: Connection:
[0m12:55:29.071954 [info ] [MainThread]:   database: google_play
[0m12:55:29.072388 [info ] [MainThread]:   schema: main
[0m12:55:29.072896 [info ] [MainThread]:   path: data/google_play.duckdb
[0m12:55:29.073399 [info ] [MainThread]:   config_options: None
[0m12:55:29.074018 [info ] [MainThread]:   extensions: None
[0m12:55:29.074435 [info ] [MainThread]:   settings: {}
[0m12:55:29.075017 [info ] [MainThread]:   external_root: .
[0m12:55:29.075740 [info ] [MainThread]:   use_credential_provider: None
[0m12:55:29.076242 [info ] [MainThread]:   attach: None
[0m12:55:29.076789 [info ] [MainThread]:   filesystems: None
[0m12:55:29.077309 [info ] [MainThread]:   remote: None
[0m12:55:29.077757 [info ] [MainThread]:   plugins: None
[0m12:55:29.078195 [info ] [MainThread]:   disable_transactions: False
[0m12:55:29.078812 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:55:29.295110 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:55:29.353192 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:55:29.353563 [debug] [MainThread]: On debug: select 1 as id
[0m12:55:29.353896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:29.369455 [debug] [MainThread]: SQL status: OK in 0.016 seconds
[0m12:55:29.370463 [debug] [MainThread]: On debug: Close
[0m12:55:29.370817 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:55:29.371348 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:55:29.371873 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:55:29.372869 [debug] [MainThread]: Command `dbt debug` failed at 12:55:29.372758 after 0.67 seconds
[0m12:55:29.373177 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:55:29.373496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ADE89E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207ADE6FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AD8238A0>]}
[0m12:55:29.373864 [debug] [MainThread]: Flushing usage events
[0m12:55:30.111624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:37.804058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D4C54C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D5F83ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D5F83B10>]}


============================== 12:56:37.808044 | 81957b83-605c-4b74-8364-b1b26d7bc354 ==============================
[0m12:56:37.808044 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:56:37.808689 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:56:37.822387 [info ] [MainThread]: dbt version: 1.11.6
[0m12:56:37.822916 [info ] [MainThread]: python version: 3.13.12
[0m12:56:37.823680 [info ] [MainThread]: python path: C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\.venv\Scripts\python.exe
[0m12:56:37.824403 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:56:37.934762 [info ] [MainThread]: Using profiles dir at .
[0m12:56:37.935338 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m12:56:37.935804 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\dbt_project.yml
[0m12:56:37.937826 [info ] [MainThread]: adapter type: duckdb
[0m12:56:37.938315 [info ] [MainThread]: adapter version: 1.10.1
[0m12:56:38.045904 [info ] [MainThread]: Configuration:
[0m12:56:38.046523 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:56:38.046989 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:56:38.047465 [info ] [MainThread]: Required dependencies:
[0m12:56:38.047958 [debug] [MainThread]: Executing "git --help"
[0m12:56:38.052727 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m12:56:38.053184 [info ] [MainThread]: Connection:
[0m12:56:38.053683 [info ] [MainThread]:   database: google_play
[0m12:56:38.054372 [info ] [MainThread]:   schema: main
[0m12:56:38.054829 [info ] [MainThread]:   path: data/google_play.duckdb
[0m12:56:38.055285 [info ] [MainThread]:   config_options: None
[0m12:56:38.055720 [info ] [MainThread]:   extensions: None
[0m12:56:38.056124 [info ] [MainThread]:   settings: {}
[0m12:56:38.056623 [info ] [MainThread]:   external_root: .
[0m12:56:38.057080 [info ] [MainThread]:   use_credential_provider: None
[0m12:56:38.057536 [info ] [MainThread]:   attach: None
[0m12:56:38.057943 [info ] [MainThread]:   filesystems: None
[0m12:56:38.058344 [info ] [MainThread]:   remote: None
[0m12:56:38.058745 [info ] [MainThread]:   plugins: None
[0m12:56:38.059352 [info ] [MainThread]:   disable_transactions: False
[0m12:56:38.060219 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:56:38.273169 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m12:56:38.327897 [debug] [MainThread]: Using duckdb connection "debug"
[0m12:56:38.328232 [debug] [MainThread]: On debug: select 1 as id
[0m12:56:38.328496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:38.346476 [debug] [MainThread]: SQL status: OK in 0.018 seconds
[0m12:56:38.347344 [debug] [MainThread]: On debug: Close
[0m12:56:38.347653 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:56:38.348141 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:56:38.348597 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m12:56:38.349454 [debug] [MainThread]: Command `dbt debug` failed at 12:56:38.349349 after 0.69 seconds
[0m12:56:38.349743 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:56:38.350051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D7661F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D763FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255D60238A0>]}
[0m12:56:38.350401 [debug] [MainThread]: Flushing usage events
[0m12:56:39.834277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:50.268939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7ABC4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7BEFBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7BEFBB10>]}


============================== 12:58:50.272943 | 6b5a8195-91bb-4206-b14f-decbb1649940 ==============================
[0m12:58:50.272943 [info ] [MainThread]: Running with dbt=1.11.6
[0m12:58:50.273603 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m12:58:50.519854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7B215A70>]}
[0m12:58:50.582421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7CFC58C0>]}
[0m12:58:50.584460 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m12:58:50.813519 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m12:58:50.814514 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:58:50.815080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7CF8B350>]}
[0m12:58:52.623777 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m12:58:52.624470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D825220>]}
[0m12:58:52.721141 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m12:58:52.726174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D9B7930>]}
[0m12:58:52.804393 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m12:58:52.806800 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m12:58:52.825252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D89C120>]}
[0m12:58:52.825674 [info ] [MainThread]: Found 4 models, 5 data tests, 588 macros
[0m12:58:52.826116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7DAE1850>]}
[0m12:58:52.827900 [info ] [MainThread]: 
[0m12:58:52.828319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:52.828700 [info ] [MainThread]: 
[0m12:58:52.829291 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:58:52.833799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m12:58:52.903899 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m12:58:52.904266 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m12:58:52.904565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:52.928005 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m12:58:52.929266 [debug] [ThreadPool]: On list_google_play: Close
[0m12:58:52.929944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m12:58:52.930382 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m12:58:52.936005 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m12:58:52.936312 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m12:58:52.936651 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:52.937566 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:58:52.938702 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m12:58:52.938996 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m12:58:52.939607 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:58:52.939896 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m12:58:52.940176 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m12:58:52.940821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:58:52.941607 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m12:58:52.941905 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m12:58:52.942180 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m12:58:52.942631 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:58:52.942929 [debug] [ThreadPool]: On create_google_play_main: Close
[0m12:58:52.944599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m12:58:52.949767 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m12:58:52.950072 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m12:58:52.950346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:52.950896 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:58:52.951180 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m12:58:52.951479 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m12:58:52.967034 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m12:58:52.968214 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m12:58:52.969394 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m12:58:52.969685 [debug] [ThreadPool]: On list_google_play_main: Close
[0m12:58:52.970366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7DC7EF10>]}
[0m12:58:52.970802 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:52.971121 [debug] [MainThread]: On master: BEGIN
[0m12:58:52.971422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:52.972008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:58:52.972295 [debug] [MainThread]: On master: COMMIT
[0m12:58:52.972577 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:52.972851 [debug] [MainThread]: On master: COMMIT
[0m12:58:52.973300 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:52.973588 [debug] [MainThread]: On master: Close
[0m12:58:52.978945 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.check_conn
[0m12:58:52.979431 [info ] [Thread-1 (]: 1 of 4 START sql view model main.check_conn .................................... [RUN]
[0m12:58:52.980097 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.check_conn'
[0m12:58:52.980440 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.check_conn
[0m12:58:52.986069 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.check_conn"
[0m12:58:52.988465 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.check_conn
[0m12:58:53.016312 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.check_conn"
[0m12:58:53.018811 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.check_conn"
[0m12:58:53.019185 [debug] [Thread-1 (]: On model.lab2_pipeline.check_conn: BEGIN
[0m12:58:53.019510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:53.020320 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:53.020659 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.check_conn"
[0m12:58:53.020993 [debug] [Thread-1 (]: On model.lab2_pipeline.check_conn: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.check_conn"} */

  
  create view "google_play"."main"."check_conn__dbt_tmp" as (
    select 1 as ok, current_timestamp as created_at
``` [cite: 140]
  );

[0m12:58:53.021710 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Parser Error: syntax error at or near "```"

LINE 6: ``` [cite: 140]
        ^
[0m12:58:53.022093 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.check_conn"} */

  
  create view "google_play"."main"."check_conn__dbt_tmp" as (
    select 1 as ok, current_timestamp as created_at
``` [cite: 140]
  );

[0m12:58:53.022438 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:58:53.022764 [debug] [Thread-1 (]: On model.lab2_pipeline.check_conn: ROLLBACK
[0m12:58:53.024581 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.check_conn'
[0m12:58:53.025021 [debug] [Thread-1 (]: On model.lab2_pipeline.check_conn: Close
[0m12:58:53.044437 [debug] [Thread-1 (]: Runtime Error in model check_conn (models\staging\check_conn.sql)
  Parser Error: syntax error at or near "```"
  
  LINE 6: ``` [cite: 140]
          ^
[0m12:58:53.046172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7B1A7A70>]}
[0m12:58:53.046744 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.check_conn ........................... [[31mERROR[0m in 0.06s]
[0m12:58:53.047519 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.check_conn
[0m12:58:53.047896 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m12:58:53.048815 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.check_conn' to be skipped because of status 'error'.  Reason: Runtime Error in model check_conn (models\staging\check_conn.sql)
  Parser Error: syntax error at or near "```"
  
  LINE 6: ``` [cite: 140]
          ^.
[0m12:58:53.048334 [info ] [Thread-1 (]: 2 of 4 START sql view model main.connection_test ............................... [RUN]
[0m12:58:53.050314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.check_conn, now model.lab2_pipeline.connection_test)
[0m12:58:53.050671 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m12:58:53.052218 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m12:58:53.053044 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m12:58:53.056188 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m12:58:53.057252 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m12:58:53.057615 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m12:58:53.057954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:53.058587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:53.058930 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m12:58:53.059269 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m12:58:53.060003 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:58:53.065829 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m12:58:53.066490 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m12:58:53.067488 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:58:53.077042 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m12:58:53.077455 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m12:58:53.077783 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m12:58:53.080943 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:58:53.089630 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m12:58:53.090043 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m12:58:53.090744 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:58:53.092804 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m12:58:53.093343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B78AC45D0>]}
[0m12:58:53.093894 [info ] [Thread-1 (]: 2 of 4 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.04s]
[0m12:58:53.094668 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m12:58:53.095047 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m12:58:53.095511 [info ] [Thread-1 (]: 3 of 4 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m12:58:53.096095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m12:58:53.096475 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m12:58:53.098164 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m12:58:53.099185 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m12:58:53.102569 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m12:58:53.103689 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m12:58:53.104077 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m12:58:53.104449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:53.105165 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:53.105557 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m12:58:53.105978 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    -- Standardize naming and cast types
    cast(appId as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m12:58:53.120257 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "appId"

LINE 7:     cast(appId as varchar) as app_id,
                 ^
[0m12:58:53.120903 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    -- Standardize naming and cast types
    cast(appId as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m12:58:53.121378 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:58:53.121717 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m12:58:53.122928 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m12:58:53.123385 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m12:58:53.127738 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 7:     cast(appId as varchar) as app_id,
                   ^
[0m12:58:53.128196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7DFDD240>]}
[0m12:58:53.128988 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.03s]
[0m12:58:53.129839 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m12:58:53.130259 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m12:58:53.130843 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 7:     cast(appId as varchar) as app_id,
                   ^.
[0m12:58:53.131434 [info ] [Thread-1 (]: 4 of 4 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m12:58:53.132298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m12:58:53.132734 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m12:58:53.134364 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m12:58:53.135365 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m12:58:53.138423 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m12:58:53.139338 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m12:58:53.139828 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m12:58:53.140158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:53.140817 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:58:53.141157 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m12:58:53.141507 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast(reviewId as varchar) as review_id,
    cast(appId as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast(at as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m12:58:53.142111 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Parser Error: syntax error at or near "as"

LINE 10:     cast(at as timestamp) as review_date
                     ^
[0m12:58:53.142480 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast(reviewId as varchar) as review_id,
    cast(appId as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast(at as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m12:58:53.142839 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:58:53.143167 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: ROLLBACK
[0m12:58:53.144352 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_reviews'
[0m12:58:53.145080 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m12:58:53.149288 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 10:     cast(at as timestamp) as review_date
                       ^
[0m12:58:53.149791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5a8195-91bb-4206-b14f-decbb1649940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D933050>]}
[0m12:58:53.150357 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model main.stg_playstore_reviews ................ [[31mERROR[0m in 0.02s]
[0m12:58:53.151188 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m12:58:53.151739 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_reviews' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 10:     cast(at as timestamp) as review_date
                       ^.
[0m12:58:53.152972 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:53.153280 [debug] [MainThread]: On master: BEGIN
[0m12:58:53.153550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:53.154207 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m12:58:53.154520 [debug] [MainThread]: On master: COMMIT
[0m12:58:53.154814 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:53.155082 [debug] [MainThread]: On master: COMMIT
[0m12:58:53.155574 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:58:53.155862 [debug] [MainThread]: On master: Close
[0m12:58:53.156384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:53.156678 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m12:58:53.156933 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m12:58:53.157324 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m12:58:53.157655 [info ] [MainThread]: 
[0m12:58:53.158191 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m12:58:53.159555 [debug] [MainThread]: Command end result
[0m12:58:53.183058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m12:58:53.185520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m12:58:53.191408 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m12:58:53.191738 [info ] [MainThread]: 
[0m12:58:53.192247 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:58:53.192749 [info ] [MainThread]: 
[0m12:58:53.193310 [error] [MainThread]: [31mFailure in model check_conn (models\staging\check_conn.sql)[0m
[0m12:58:53.193826 [error] [MainThread]:   Runtime Error in model check_conn (models\staging\check_conn.sql)
  Parser Error: syntax error at or near "```"
  
  LINE 6: ``` [cite: 140]
          ^
[0m12:58:53.194315 [info ] [MainThread]: 
[0m12:58:53.194831 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\check_conn.sql
[0m12:58:53.195296 [info ] [MainThread]: 
[0m12:58:53.195820 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m12:58:53.196356 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 7:     cast(appId as varchar) as app_id,
                   ^
[0m12:58:53.196846 [info ] [MainThread]: 
[0m12:58:53.197378 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m12:58:53.197821 [info ] [MainThread]: 
[0m12:58:53.198315 [error] [MainThread]: [31mFailure in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)[0m
[0m12:58:53.198817 [error] [MainThread]:   Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Parser Error: syntax error at or near "as"
  
  LINE 10:     cast(at as timestamp) as review_date
                       ^
[0m12:58:53.199265 [info ] [MainThread]: 
[0m12:58:53.199742 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_reviews.sql
[0m12:58:53.200186 [info ] [MainThread]: 
[0m12:58:53.200658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m12:58:53.201297 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:58:53.202485 [debug] [MainThread]: Command `dbt run` failed at 12:58:53.202332 after 3.13 seconds
[0m12:58:53.202910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D8104D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7BD9AC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D8B5F10>]}
[0m12:58:53.203305 [debug] [MainThread]: Flushing usage events
[0m12:58:54.110670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:54.929576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C0984C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C1CCBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C1CCBB10>]}


============================== 13:01:54.933816 | b4585e0b-1ce8-4d17-a15c-3b3682a397f3 ==============================
[0m13:01:54.933816 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:01:54.934523 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:01:55.171292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C0FEDA70>]}
[0m13:01:55.236059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C1DCD8C0>]}
[0m13:01:55.238124 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:01:55.462299 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:01:55.620763 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m13:01:55.621167 [debug] [MainThread]: Partial parsing: deleted file: lab2_pipeline://models\staging\check_conn.sql
[0m13:01:55.621616 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:01:55.622008 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:01:55.996266 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:01:55.997066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C35C1E50>]}
[0m13:01:56.067797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:01:56.072891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C3636D50>]}
[0m13:01:56.142916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:01:56.145021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:01:56.163319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C39225F0>]}
[0m13:01:56.163737 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:01:56.164178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C3951F30>]}
[0m13:01:56.165903 [info ] [MainThread]: 
[0m13:01:56.166426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:56.166847 [info ] [MainThread]: 
[0m13:01:56.167381 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:01:56.171845 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:01:56.243006 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:01:56.243384 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:01:56.243682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:56.259012 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:01:56.260236 [debug] [ThreadPool]: On list_google_play: Close
[0m13:01:56.260875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:01:56.261307 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:01:56.267114 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:01:56.267434 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:01:56.267716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:56.268676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:01:56.269790 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:01:56.270087 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:01:56.270548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:56.270828 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:01:56.271109 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:01:56.271617 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:56.272366 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:01:56.272658 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:01:56.272931 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:01:56.273378 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:56.273669 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:01:56.275102 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:01:56.280087 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:01:56.280389 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:01:56.280719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:56.281233 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:01:56.281519 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:01:56.281808 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:01:56.296736 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:01:56.297983 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:01:56.298934 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:01:56.299224 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:01:56.300134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C395E990>]}
[0m13:01:56.300540 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:56.300820 [debug] [MainThread]: On master: BEGIN
[0m13:01:56.301082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:56.301614 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:01:56.301908 [debug] [MainThread]: On master: COMMIT
[0m13:01:56.302186 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:56.302452 [debug] [MainThread]: On master: COMMIT
[0m13:01:56.302898 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:56.303182 [debug] [MainThread]: On master: Close
[0m13:01:56.306995 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:01:56.307463 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:01:56.308115 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:01:56.308456 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:01:56.314026 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:01:56.314778 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:01:56.343867 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:01:56.344780 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.345135 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:01:56.345457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:01:56.346222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:56.346559 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.346912 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:01:56.347651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:56.352975 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.353328 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:01:56.353943 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:56.356640 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.357040 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:01:56.357648 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:56.368207 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:01:56.368561 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.368893 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:01:56.371687 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:01:56.376790 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:01:56.377159 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:01:56.379346 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:01:56.381654 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:01:56.383278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C3A126D0>]}
[0m13:01:56.383835 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.07s]
[0m13:01:56.384607 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:01:56.384978 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:01:56.385415 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:01:56.385991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:01:56.386345 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:01:56.388151 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:01:56.388878 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:01:56.392112 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:01:56.393114 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:01:56.393653 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:01:56.394032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:56.394927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:56.395307 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:01:56.395707 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast("title" as varchar) as app_name,
    cast("score" as float) as rating,
    cast("genre" as varchar) as category,
    cast("developer" as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:01:56.401076 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "appId"

LINE 6:     cast("appId" as varchar) as app_id,
                 ^
[0m13:01:56.401514 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast("title" as varchar) as app_name,
    cast("score" as float) as rating,
    cast("genre" as varchar) as category,
    cast("developer" as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:01:56.401866 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:01:56.402203 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:01:56.403958 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:01:56.404412 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:01:56.410447 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:01:56.410921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C3DEC0F0>]}
[0m13:01:56.411528 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:01:56.412321 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:01:56.412730 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:01:56.413294 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^.
[0m13:01:56.413824 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:01:56.414963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:01:56.415330 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:01:56.417298 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:01:56.418115 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:01:56.421308 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:01:56.422403 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:01:56.422828 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:01:56.423220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:56.423929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:56.424311 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:01:56.424703 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast("appId" as varchar) as app_id,
    cast("content" as varchar) as review_text,
    cast("score" as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:01:56.440498 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "app_id", "app_name", "at", "reviewId"

LINE 7:     cast("appId" as varchar) as app_id,
                 ^
[0m13:01:56.440958 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast("appId" as varchar) as app_id,
    cast("content" as varchar) as review_text,
    cast("score" as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:01:56.441427 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:01:56.441813 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: ROLLBACK
[0m13:01:56.443209 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_reviews'
[0m13:01:56.443703 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:01:56.447820 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "app_id", "app_name", "at", "reviewId"
  
  LINE 7:     cast("appId" as varchar) as app_id,
                   ^
[0m13:01:56.448257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4585e0b-1ce8-4d17-a15c-3b3682a397f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C3E3A4D0>]}
[0m13:01:56.448815 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.stg_playstore_reviews ................ [[31mERROR[0m in 0.03s]
[0m13:01:56.449577 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:01:56.450124 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_reviews' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "app_id", "app_name", "at", "reviewId"
  
  LINE 7:     cast("appId" as varchar) as app_id,
                   ^.
[0m13:01:56.451329 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:56.451623 [debug] [MainThread]: On master: BEGIN
[0m13:01:56.451888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:56.452524 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:01:56.452819 [debug] [MainThread]: On master: COMMIT
[0m13:01:56.453100 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:56.453366 [debug] [MainThread]: On master: COMMIT
[0m13:01:56.453814 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:56.454101 [debug] [MainThread]: On master: Close
[0m13:01:56.454445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:56.454704 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:01:56.454963 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:01:56.455208 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:01:56.455521 [info ] [MainThread]: 
[0m13:01:56.455984 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:01:56.457217 [debug] [MainThread]: Command end result
[0m13:01:56.482941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:01:56.485575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:01:56.491529 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:01:56.491904 [info ] [MainThread]: 
[0m13:01:56.492433 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:01:56.492964 [info ] [MainThread]: 
[0m13:01:56.493521 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:01:56.494075 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:01:56.494591 [info ] [MainThread]: 
[0m13:01:56.495128 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:01:56.495577 [info ] [MainThread]: 
[0m13:01:56.496070 [error] [MainThread]: [31mFailure in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)[0m
[0m13:01:56.496567 [error] [MainThread]:   Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "app_id", "app_name", "at", "reviewId"
  
  LINE 7:     cast("appId" as varchar) as app_id,
                   ^
[0m13:01:56.497050 [info ] [MainThread]: 
[0m13:01:56.497536 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_reviews.sql
[0m13:01:56.497958 [info ] [MainThread]: 
[0m13:01:56.498345 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m13:01:56.498964 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:01:56.499905 [debug] [MainThread]: Command `dbt run` failed at 13:01:56.499794 after 1.76 seconds
[0m13:01:56.500295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C1D01780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4BB5442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4C0E7CA10>]}
[0m13:01:56.500660 [debug] [MainThread]: Flushing usage events
[0m13:01:57.512696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:47.349427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E01854C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E02B8BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E02B8BB10>]}


============================== 13:03:47.353331 | b1634f4d-e2c7-4b39-8b12-6263ee1e2136 ==============================
[0m13:03:47.353331 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:03:47.353958 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:03:47.588362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E01EA5940>]}
[0m13:03:47.651717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E02C8D8C0>]}
[0m13:03:47.653851 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:03:47.876079 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:03:48.026590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:03:48.027240 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:03:48.027545 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:03:48.027869 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:03:48.408379 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:03:48.408991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E04502450>]}
[0m13:03:48.477499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:03:48.482383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E04573980>]}
[0m13:03:48.558763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:03:48.561079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:03:48.579437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0485E6D0>]}
[0m13:03:48.579865 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:03:48.580349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0488DF30>]}
[0m13:03:48.582116 [info ] [MainThread]: 
[0m13:03:48.582659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:48.583140 [info ] [MainThread]: 
[0m13:03:48.583745 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:03:48.588220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:03:48.658332 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:03:48.658717 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:03:48.659014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:48.674458 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:03:48.675703 [debug] [ThreadPool]: On list_google_play: Close
[0m13:03:48.676348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:03:48.676772 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:03:48.682673 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:03:48.683001 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:03:48.683287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:48.684219 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:03:48.685341 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:03:48.685630 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:03:48.686093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:48.686374 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:03:48.686650 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:03:48.687165 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:48.687914 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:03:48.688261 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:03:48.688537 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:03:48.688993 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:48.689288 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:03:48.690717 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:03:48.696148 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:03:48.696477 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:03:48.696760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:48.697325 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:03:48.697617 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:03:48.697904 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:03:48.712883 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:03:48.714138 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:03:48.715091 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:03:48.715381 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:03:48.716297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E048A2990>]}
[0m13:03:48.716703 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:48.716984 [debug] [MainThread]: On master: BEGIN
[0m13:03:48.717246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:48.717763 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:48.718056 [debug] [MainThread]: On master: COMMIT
[0m13:03:48.718363 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:48.718630 [debug] [MainThread]: On master: COMMIT
[0m13:03:48.719068 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:48.719352 [debug] [MainThread]: On master: Close
[0m13:03:48.723141 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:03:48.723628 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:03:48.724293 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:03:48.724743 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:03:48.730281 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:03:48.731046 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:03:48.760302 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:03:48.761268 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.761654 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:03:48.762020 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:48.762881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:48.763255 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.763663 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:03:48.764485 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:03:48.770326 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.770739 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:03:48.771419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:03:48.774459 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.774872 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:03:48.775579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:03:48.787552 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:03:48.787955 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.788327 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:03:48.793904 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:03:48.798809 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:03:48.799198 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:03:48.801168 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:03:48.803326 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:03:48.805039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E0494A570>]}
[0m13:03:48.805670 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:03:48.806512 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:03:48.806946 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:03:48.807416 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:03:48.808061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:03:48.808426 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:03:48.810375 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:03:48.811181 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:03:48.814058 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:03:48.814885 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:03:48.815261 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:03:48.815615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:48.816303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:48.816681 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:03:48.817056 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(app_id as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:03:48.822340 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Column "app_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:03:48.822866 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(app_id as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:03:48.823272 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:03:48.823646 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:03:48.825606 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:03:48.826106 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:03:48.833094 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Column "app_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:03:48.833697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E04D240F0>]}
[0m13:03:48.834324 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.03s]
[0m13:03:48.835121 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:03:48.835554 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:03:48.837109 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Column "app_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined.
[0m13:03:48.836463 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:03:48.838386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:03:48.839018 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:03:48.841116 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.841990 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:03:48.845122 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.846013 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.846459 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:03:48.846832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:48.847608 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:48.848007 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.848384 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:03:48.852611 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:03:48.855463 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.855864 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:03:48.856588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:03:48.858100 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:03:48.858470 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.858840 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:03:48.863712 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:03:48.865792 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:03:48.866143 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:03:48.867291 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:48.868798 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:03:48.869273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1634f4d-e2c7-4b39-8b12-6263ee1e2136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E04D75750>]}
[0m13:03:48.869812 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.03s]
[0m13:03:48.870515 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:03:48.871778 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:48.872083 [debug] [MainThread]: On master: BEGIN
[0m13:03:48.872353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:48.873176 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:48.873548 [debug] [MainThread]: On master: COMMIT
[0m13:03:48.873856 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:48.874152 [debug] [MainThread]: On master: COMMIT
[0m13:03:48.874696 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:48.875002 [debug] [MainThread]: On master: Close
[0m13:03:48.875390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:48.875658 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:03:48.875909 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:03:48.876158 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:03:48.876487 [info ] [MainThread]: 
[0m13:03:48.877073 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:03:48.878468 [debug] [MainThread]: Command end result
[0m13:03:48.903362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:03:48.905615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:03:48.911421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:03:48.911751 [info ] [MainThread]: 
[0m13:03:48.912267 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:03:48.912802 [info ] [MainThread]: 
[0m13:03:48.913339 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:03:48.913896 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Column "app_id" referenced that exists in the SELECT clause - but this column cannot be referenced before it is defined
[0m13:03:48.914372 [info ] [MainThread]: 
[0m13:03:48.914920 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:03:48.915406 [info ] [MainThread]: 
[0m13:03:48.915915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:03:48.916543 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:03:48.917499 [debug] [MainThread]: Command `dbt run` failed at 13:03:48.917385 after 1.71 seconds
[0m13:03:48.917865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E02BC1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7C3242F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E7FCC1CD0>]}
[0m13:03:48.918219 [debug] [MainThread]: Flushing usage events
[0m13:03:49.824885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:31.335460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EF594C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F08DFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F08DFB10>]}


============================== 13:05:31.339486 | 88a93b71-7839-4de3-9c90-5581df54ce4d ==============================
[0m13:05:31.339486 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:05:31.340126 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:05:31.569631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EFBFDA70>]}
[0m13:05:31.632418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F09D18C0>]}
[0m13:05:31.634514 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:05:31.852006 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:05:31.996704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:31.997382 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:05:31.997684 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:05:32.393324 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:05:32.394071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F2252450>]}
[0m13:05:32.463881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:05:32.468516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F22C2E40>]}
[0m13:05:32.538854 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:05:32.540910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:05:32.559957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F25AE6D0>]}
[0m13:05:32.560385 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:05:32.560837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F25D5F30>]}
[0m13:05:32.562565 [info ] [MainThread]: 
[0m13:05:32.563037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:32.563468 [info ] [MainThread]: 
[0m13:05:32.564047 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:05:32.568488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:05:32.640246 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:05:32.640611 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:05:32.640910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:32.664215 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:05:32.665459 [debug] [ThreadPool]: On list_google_play: Close
[0m13:05:32.666090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:05:32.666565 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:05:32.672081 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:05:32.672417 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:05:32.672698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:32.673518 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:05:32.674613 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:05:32.674897 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:05:32.675349 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:05:32.675627 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:05:32.675969 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:05:32.676480 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:05:32.677220 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:05:32.677512 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:05:32.677792 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:05:32.678235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:05:32.678527 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:05:32.679936 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:05:32.684931 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:05:32.685239 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:05:32.685514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:32.686070 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:05:32.686354 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:05:32.686678 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:05:32.701108 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:05:32.702406 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:05:32.703348 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:05:32.703641 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:05:32.704685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F25F2990>]}
[0m13:05:32.705104 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:32.705386 [debug] [MainThread]: On master: BEGIN
[0m13:05:32.705651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:32.706231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:05:32.706516 [debug] [MainThread]: On master: COMMIT
[0m13:05:32.706792 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:32.707065 [debug] [MainThread]: On master: COMMIT
[0m13:05:32.707548 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:05:32.707832 [debug] [MainThread]: On master: Close
[0m13:05:32.711654 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:05:32.712117 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:05:32.712798 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:05:32.713224 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:05:32.718748 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:05:32.719491 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:05:32.748793 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:05:32.749677 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.750065 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:05:32.750383 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:32.751145 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:05:32.751482 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.751822 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:05:32.752550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:32.757732 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.758081 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:05:32.758684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:32.761407 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.761759 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:05:32.762358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:32.772910 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:05:32.773279 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.773630 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:05:32.776592 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:05:32.781590 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:05:32.781945 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:05:32.784069 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:05:32.786360 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:05:32.787949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F268E570>]}
[0m13:05:32.788508 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.07s]
[0m13:05:32.789271 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:05:32.789642 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:05:32.790079 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:05:32.790650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:05:32.790999 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:05:32.792982 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:05:32.793743 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:05:32.796389 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:05:32.797150 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:05:32.797488 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:05:32.797810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:32.798421 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:05:32.798750 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:05:32.799096 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', normalize_names=true)
  );

[0m13:05:32.803944 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appid" not found in FROM clause!
Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"

LINE 6:     cast(appid as varchar) as app_id,
                 ^
[0m13:05:32.804324 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', normalize_names=true)
  );

[0m13:05:32.804671 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:05:32.805002 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:05:32.806696 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:05:32.807168 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:05:32.814180 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^
[0m13:05:32.814755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F2A780F0>]}
[0m13:05:32.815418 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:05:32.816172 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:05:32.816654 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:05:32.817704 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^.
[0m13:05:32.817136 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:05:32.818966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:05:32.819371 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:05:32.821685 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.822859 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:05:32.826177 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.827205 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.827785 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:05:32.828276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:32.829053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:05:32.829431 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.829832 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:05:32.834369 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:05:32.837651 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.838069 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:05:32.838847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:32.841715 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.842150 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:05:32.842920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:05:32.844635 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:05:32.845185 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.845617 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:05:32.848100 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:05:32.850743 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:05:32.851128 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:05:32.853417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:05:32.855030 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:05:32.855589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a93b71-7839-4de3-9c90-5581df54ce4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F2AC7550>]}
[0m13:05:32.856194 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:05:32.857028 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:05:32.858260 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:32.858594 [debug] [MainThread]: On master: BEGIN
[0m13:05:32.858876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:32.859465 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:05:32.859778 [debug] [MainThread]: On master: COMMIT
[0m13:05:32.860054 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:32.860321 [debug] [MainThread]: On master: COMMIT
[0m13:05:32.860755 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:05:32.861040 [debug] [MainThread]: On master: Close
[0m13:05:32.861377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:32.861637 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:05:32.861897 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:05:32.862141 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:05:32.862453 [info ] [MainThread]: 
[0m13:05:32.862917 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:05:32.864100 [debug] [MainThread]: Command end result
[0m13:05:32.888292 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:05:32.890722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:05:32.896600 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:05:32.896978 [info ] [MainThread]: 
[0m13:05:32.897498 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:05:32.897950 [info ] [MainThread]: 
[0m13:05:32.898466 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:05:32.898980 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^
[0m13:05:32.899462 [info ] [MainThread]: 
[0m13:05:32.899952 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:05:32.900388 [info ] [MainThread]: 
[0m13:05:32.900856 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:05:32.901462 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:05:32.902367 [debug] [MainThread]: Command `dbt run` failed at 13:05:32.902255 after 1.72 seconds
[0m13:05:32.902728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F0915780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2EA0B42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F06E57F0>]}
[0m13:05:32.903113 [debug] [MainThread]: Flushing usage events
[0m13:05:33.781385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:47.636430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF57B4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF6AEBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF6AEBB10>]}


============================== 13:07:47.640379 | 6057c029-7315-4507-a452-cb04fc9f2c5f ==============================
[0m13:07:47.640379 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:07:47.641030 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:07:47.872387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF5DEDA70>]}
[0m13:07:47.935128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF6BE98C0>]}
[0m13:07:47.937329 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:07:48.164567 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:07:48.298822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:48.299171 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:07:48.299423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:48.305145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:07:48.337248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF839E450>]}
[0m13:07:48.405633 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:07:48.407716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:07:48.424762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF7F9CC80>]}
[0m13:07:48.425217 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:07:48.425704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF6B4BD90>]}
[0m13:07:48.427566 [info ] [MainThread]: 
[0m13:07:48.427988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:48.428368 [info ] [MainThread]: 
[0m13:07:48.428896 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:07:48.433371 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:07:48.511256 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:07:48.511633 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:07:48.511936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:48.536300 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:07:48.537583 [debug] [ThreadPool]: On list_google_play: Close
[0m13:07:48.538257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:07:48.538716 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:07:48.544445 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:07:48.544758 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:07:48.545047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:48.545927 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:07:48.547035 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:07:48.547328 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:07:48.547788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:48.548089 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:07:48.548371 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:07:48.548882 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:48.549663 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:07:48.549974 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:07:48.550256 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:07:48.550705 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:07:48.551005 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:07:48.552467 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:07:48.559778 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:07:48.560136 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:07:48.560417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:48.561008 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:07:48.561300 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:07:48.561602 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:07:48.576151 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:07:48.577416 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:07:48.578450 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:07:48.578759 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:07:48.579817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF87F2000>]}
[0m13:07:48.580288 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:48.580576 [debug] [MainThread]: On master: BEGIN
[0m13:07:48.580845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:48.581379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:07:48.581671 [debug] [MainThread]: On master: COMMIT
[0m13:07:48.581953 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:48.582231 [debug] [MainThread]: On master: COMMIT
[0m13:07:48.582680 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:07:48.582970 [debug] [MainThread]: On master: Close
[0m13:07:48.587029 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:07:48.587542 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:07:48.588236 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:07:48.588586 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:07:48.594180 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:07:48.594929 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:07:48.666996 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:07:48.667899 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.668251 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:07:48.668589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:07:48.669370 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:48.669711 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.670051 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:07:48.670812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:07:48.676093 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.676450 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:07:48.677068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:07:48.679813 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.680164 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:07:48.680854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:07:48.691389 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:07:48.691738 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.692063 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:07:48.695151 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:07:48.700503 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:07:48.700869 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:07:48.703084 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:07:48.705402 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:07:48.707007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF8602090>]}
[0m13:07:48.707578 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.12s]
[0m13:07:48.708362 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:07:48.708740 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:07:48.709168 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:07:48.709771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:07:48.710115 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:07:48.711756 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:07:48.712503 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:07:48.715475 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:07:48.716227 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:07:48.716572 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:07:48.716893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:48.717512 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:48.717846 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:07:48.718188 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', normalize_names=true)
  );

[0m13:07:48.722668 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appid" not found in FROM clause!
Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"

LINE 6:     cast(appid as varchar) as app_id,
                 ^
[0m13:07:48.723052 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', normalize_names=true)
  );

[0m13:07:48.723418 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:07:48.723752 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:07:48.725494 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:07:48.726439 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:07:48.733129 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^
[0m13:07:48.733920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF87F4520>]}
[0m13:07:48.734709 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:07:48.735628 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:07:48.736244 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:07:48.737385 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^.
[0m13:07:48.736693 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:07:48.739004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:07:48.739444 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:07:48.741055 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.742594 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:07:48.747093 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.748226 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.748670 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:07:48.748993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:48.749761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:07:48.750204 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.750588 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:07:48.755097 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:07:48.758036 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.758431 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:07:48.759204 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:07:48.762042 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.762428 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:07:48.763301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:07:48.764696 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:07:48.765046 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.765378 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:07:48.767617 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:07:48.770013 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:07:48.770365 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:07:48.772515 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:07:48.774048 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:07:48.774620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6057c029-7315-4507-a452-cb04fc9f2c5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF8183BB0>]}
[0m13:07:48.775165 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:07:48.775933 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:07:48.777063 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:48.777355 [debug] [MainThread]: On master: BEGIN
[0m13:07:48.777620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:48.778168 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:07:48.778455 [debug] [MainThread]: On master: COMMIT
[0m13:07:48.778742 [debug] [MainThread]: Using duckdb connection "master"
[0m13:07:48.779011 [debug] [MainThread]: On master: COMMIT
[0m13:07:48.779448 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:07:48.779734 [debug] [MainThread]: On master: Close
[0m13:07:48.780073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:48.780335 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:07:48.780592 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:07:48.780837 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:07:48.781154 [info ] [MainThread]: 
[0m13:07:48.781620 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:07:48.782937 [debug] [MainThread]: Command end result
[0m13:07:48.807526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:07:48.810079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:07:48.815851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:07:48.816180 [info ] [MainThread]: 
[0m13:07:48.816691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:07:48.817179 [info ] [MainThread]: 
[0m13:07:48.817719 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:07:48.818256 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appid" not found in FROM clause!
  Candidate bindings: "appidtitledeveloperscoreratingsinstallsgenreprice"
  
  LINE 6:     cast(appid as varchar) as app_id,
                   ^
[0m13:07:48.818756 [info ] [MainThread]: 
[0m13:07:48.819269 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:07:48.819728 [info ] [MainThread]: 
[0m13:07:48.820233 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:07:48.821133 [debug] [MainThread]: Command `dbt run` failed at 13:07:48.821019 after 1.33 seconds
[0m13:07:48.821491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF84918D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF8491C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCF6B21780>]}
[0m13:07:48.821840 [debug] [MainThread]: Flushing usage events
[0m13:07:49.644345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:54.897286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021087E94C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210891DFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210891DFB10>]}


============================== 13:09:54.901387 | dde402f7-2f7b-43e1-a597-3672455b6b45 ==============================
[0m13:09:54.901387 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:09:54.901999 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:09:55.182049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210884FDA70>]}
[0m13:09:55.252411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210892DD8C0>]}
[0m13:09:55.254779 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:09:55.500185 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:09:55.667904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:55.668637 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:09:55.668978 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:09:56.119718 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:09:56.120910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AADE450>]}
[0m13:09:56.202632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:09:56.207130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AB4EE40>]}
[0m13:09:56.277237 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:09:56.279425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:09:56.297335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AE3A6D0>]}
[0m13:09:56.297762 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:09:56.298219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AE6DF30>]}
[0m13:09:56.299985 [info ] [MainThread]: 
[0m13:09:56.300404 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:56.300801 [info ] [MainThread]: 
[0m13:09:56.301322 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:09:56.306006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:09:56.391760 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:09:56.392240 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:09:56.392629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:56.428553 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:09:56.429971 [debug] [ThreadPool]: On list_google_play: Close
[0m13:09:56.430858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:09:56.431335 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:09:56.437854 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:09:56.438238 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:09:56.438577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:56.439720 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:09:56.441046 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:09:56.441405 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:09:56.442013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:56.442359 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:09:56.442691 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:09:56.443309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:56.444177 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:09:56.444527 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:09:56.444849 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:09:56.445568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:09:56.445922 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:09:56.447609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:09:56.452965 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:09:56.453269 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:09:56.453546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:56.454118 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:09:56.454439 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:09:56.454733 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:09:56.469031 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:09:56.470372 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:09:56.471982 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:09:56.472593 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:09:56.474357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AE82990>]}
[0m13:09:56.475147 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:56.475660 [debug] [MainThread]: On master: BEGIN
[0m13:09:56.476127 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:56.477139 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:09:56.477691 [debug] [MainThread]: On master: COMMIT
[0m13:09:56.478179 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:56.478680 [debug] [MainThread]: On master: COMMIT
[0m13:09:56.479649 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:09:56.480128 [debug] [MainThread]: On master: Close
[0m13:09:56.484990 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:09:56.485786 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:09:56.486741 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:09:56.487329 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:09:56.498397 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:09:56.500242 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:09:56.539101 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:09:56.540744 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.541433 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:09:56.542003 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:09:56.543937 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:09:56.544638 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.545259 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:09:56.546690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:09:56.553300 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.553710 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:09:56.554551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:09:56.557484 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.557830 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:09:56.558509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:09:56.569822 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:09:56.570234 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.570581 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:09:56.573177 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:09:56.578002 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:09:56.578391 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:09:56.580247 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:09:56.582366 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:09:56.584073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108AF1E570>]}
[0m13:09:56.584707 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.10s]
[0m13:09:56.585489 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:09:56.585911 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:09:56.586480 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:09:56.587081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:09:56.587483 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:09:56.589604 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:09:56.590474 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:09:56.593609 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:09:56.594487 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:09:56.594914 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:09:56.595317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:56.596091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:09:56.596502 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:09:56.596911 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',')
  );

[0m13:09:56.600460 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
It was not possible to automatically detect the CSV parsing dialect
The search space used was:
Delimiter Candidates: ','
Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
Comment Candidates: '\0', '#'
Encoding: utf-8
Possible fixes:
* Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
* Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
* Delimiter is set to ','. Consider unsetting it.
* Set quote (e.g., quote='"')
* Set escape (e.g., escape='"')
* Set comment (e.g., comment='#')
* Set skip (skip=${n}) to skip ${n} lines at the top of the file
* Enable ignore errors (ignore_errors=true) to ignore potential errors
* Enable null padding (null_padding=true) to pad missing columns with NULL values
* Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
* Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)


LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
              ^
[0m13:09:56.600881 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',')
  );

[0m13:09:56.601528 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:09:56.601989 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:09:56.603852 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:09:56.604325 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:09:56.610474 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:09:56.611140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108B3040F0>]}
[0m13:09:56.611804 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:09:56.612812 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:09:56.613259 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:09:56.613831 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^.
[0m13:09:56.614355 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:09:56.615469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:09:56.615817 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:09:56.618393 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.619502 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:09:56.622774 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.623726 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.624129 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:09:56.624483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:56.625162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:09:56.625527 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.625912 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:09:56.630606 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:09:56.633973 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.634413 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:09:56.635192 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:09:56.638694 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.639169 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:09:56.639979 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:09:56.641801 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:09:56.642248 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.642636 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:09:56.644781 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:09:56.647353 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:09:56.647759 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:09:56.649954 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:09:56.651263 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:09:56.651779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dde402f7-2f7b-43e1-a597-3672455b6b45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108B357550>]}
[0m13:09:56.652390 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:09:56.653194 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:09:56.654520 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:56.654851 [debug] [MainThread]: On master: BEGIN
[0m13:09:56.655154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:56.655726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:09:56.656035 [debug] [MainThread]: On master: COMMIT
[0m13:09:56.656345 [debug] [MainThread]: Using duckdb connection "master"
[0m13:09:56.656617 [debug] [MainThread]: On master: COMMIT
[0m13:09:56.657089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:09:56.657382 [debug] [MainThread]: On master: Close
[0m13:09:56.657719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:56.657978 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:09:56.658230 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:09:56.658475 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:09:56.658788 [info ] [MainThread]: 
[0m13:09:56.659253 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:09:56.660559 [debug] [MainThread]: Command end result
[0m13:09:56.684840 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:09:56.687493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:09:56.693469 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:09:56.693796 [info ] [MainThread]: 
[0m13:09:56.694305 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:09:56.694784 [info ] [MainThread]: 
[0m13:09:56.695453 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:09:56.696160 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:09:56.696853 [info ] [MainThread]: 
[0m13:09:56.697386 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:09:56.697864 [info ] [MainThread]: 
[0m13:09:56.698348 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:09:56.698986 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:09:56.699942 [debug] [MainThread]: Command `dbt run` failed at 13:09:56.699827 after 1.94 seconds
[0m13:09:56.700308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021089211780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210829942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108B30FB30>]}
[0m13:09:56.700665 [debug] [MainThread]: Flushing usage events
[0m13:09:57.552783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:17.479326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D581B54C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D582E9FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D582E9FB10>]}


============================== 13:11:17.483238 | 426e9d3b-9f95-40b6-932f-2c3ed7f14e8b ==============================
[0m13:11:17.483238 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:11:17.483922 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:11:17.720349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D582199940>]}
[0m13:11:17.785252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D582F958C0>]}
[0m13:11:17.787602 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:11:18.018787 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:11:18.178026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:18.178682 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:11:18.178994 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:11:18.566515 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:11:18.567190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D58472E450>]}
[0m13:11:18.635179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:11:18.639623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5847A2E40>]}
[0m13:11:18.710261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:11:18.712611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:11:18.732095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584A8E6D0>]}
[0m13:11:18.732531 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:11:18.733118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584ABDF30>]}
[0m13:11:18.734942 [info ] [MainThread]: 
[0m13:11:18.735435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:11:18.735880 [info ] [MainThread]: 
[0m13:11:18.736492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:11:18.741059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:11:18.815228 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:11:18.815609 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:11:18.815923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:18.840517 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m13:11:18.841783 [debug] [ThreadPool]: On list_google_play: Close
[0m13:11:18.842431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:11:18.842865 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:11:18.848725 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:11:18.849057 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:11:18.849355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:18.850228 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:11:18.851416 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:11:18.851711 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:11:18.852179 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:11:18.852474 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:11:18.852760 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:11:18.853282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:11:18.854058 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:11:18.854368 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:11:18.854649 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:11:18.855110 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:11:18.855475 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:11:18.856964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:11:18.862148 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:11:18.862469 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:11:18.862746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:18.863285 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:11:18.863631 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:11:18.863930 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:11:18.878407 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:11:18.879759 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:11:18.880794 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:11:18.881091 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:11:18.882103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584AD2990>]}
[0m13:11:18.882519 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:18.882806 [debug] [MainThread]: On master: BEGIN
[0m13:11:18.883075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:18.883615 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:11:18.883915 [debug] [MainThread]: On master: COMMIT
[0m13:11:18.884195 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:18.884465 [debug] [MainThread]: On master: COMMIT
[0m13:11:18.884917 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:11:18.885207 [debug] [MainThread]: On master: Close
[0m13:11:18.889154 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:11:18.889634 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:11:18.890320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:11:18.890664 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:11:18.896476 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:11:18.897447 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:11:18.927808 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:11:18.928701 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.929088 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:11:18.929411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:18.930155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:11:18.930484 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.930812 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:11:18.931562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:11:18.936731 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.937072 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:11:18.937678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:11:18.940303 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.940672 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:11:18.941244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:11:18.951637 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:11:18.951984 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.952298 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:11:18.955381 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:11:18.960646 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:11:18.961010 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:11:18.963310 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:11:18.965616 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:11:18.967258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584B7A570>]}
[0m13:11:18.967821 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:11:18.968599 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:11:18.968974 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:11:18.969402 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:11:18.969987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:11:18.970334 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:11:18.972171 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:11:18.972885 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:11:18.975948 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:11:18.976873 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:11:18.977232 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:11:18.977614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:18.978356 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:11:18.978786 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:11:18.979176 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:11:18.984543 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "appId"

LINE 6:     cast("appId" as varchar) as app_id,
                 ^
[0m13:11:18.984987 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:11:18.985342 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:11:18.985705 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:11:18.987564 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:11:18.988016 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:11:18.994081 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:11:18.994557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584F580F0>]}
[0m13:11:18.995139 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:11:18.995945 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:11:18.996350 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:11:18.997343 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^.
[0m13:11:18.996819 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:11:18.998547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:11:18.998895 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:11:19.001334 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.002219 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:11:19.005455 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.006438 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.006904 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:11:19.007259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:19.007941 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:11:19.008365 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.008775 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:11:19.013971 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:11:19.017170 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.017563 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:11:19.018256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:11:19.020946 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.021429 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:11:19.022178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:11:19.023710 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:11:19.024122 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.024505 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:11:19.026879 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:11:19.029755 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:11:19.030182 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:11:19.032240 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:11:19.033479 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:11:19.033999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '426e9d3b-9f95-40b6-932f-2c3ed7f14e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D584FA7550>]}
[0m13:11:19.034578 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:11:19.035377 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:11:19.036638 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:19.036960 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.037244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:19.037821 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:11:19.038116 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.038397 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:19.038666 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.039110 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:11:19.039401 [debug] [MainThread]: On master: Close
[0m13:11:19.039755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:19.040018 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:11:19.040278 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:11:19.040525 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:11:19.040839 [info ] [MainThread]: 
[0m13:11:19.041314 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:11:19.042669 [debug] [MainThread]: Command end result
[0m13:11:19.067556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:11:19.070638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:11:19.076905 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:11:19.077247 [info ] [MainThread]: 
[0m13:11:19.077780 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:11:19.078260 [info ] [MainThread]: 
[0m13:11:19.078789 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:11:19.079311 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:11:19.079792 [info ] [MainThread]: 
[0m13:11:19.080295 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:11:19.080748 [info ] [MainThread]: 
[0m13:11:19.081223 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:11:19.081933 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:11:19.082860 [debug] [MainThread]: Command `dbt run` failed at 13:11:19.082749 after 1.74 seconds
[0m13:11:19.083207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D582ED5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5FC5F42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5827D3590>]}
[0m13:11:19.083732 [debug] [MainThread]: Flushing usage events
[0m13:11:19.981207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:06.854285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC7724C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC8A5BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC8A5BB10>]}


============================== 13:12:06.858452 | 2708ac46-c4b4-40f6-a676-5b3b10c72657 ==============================
[0m13:12:06.858452 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:12:06.859127 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:12:07.090306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC7D7D940>]}
[0m13:12:07.155365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC8B518C0>]}
[0m13:12:07.157690 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:12:07.376331 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:12:07.511870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:07.512211 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:12:07.512459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:07.518143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:12:07.550407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA2EE450>]}
[0m13:12:07.619594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:12:07.621617 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:12:07.639662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC9F9CC80>]}
[0m13:12:07.640088 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:12:07.640598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC8ABBD90>]}
[0m13:12:07.642368 [info ] [MainThread]: 
[0m13:12:07.642827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:07.643260 [info ] [MainThread]: 
[0m13:12:07.643862 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:07.648850 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:12:07.719532 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:12:07.719899 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:12:07.720192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:07.744213 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:12:07.745454 [debug] [ThreadPool]: On list_google_play: Close
[0m13:12:07.746081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:12:07.746551 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:12:07.752196 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:07.752499 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:12:07.752777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:07.753624 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:07.754709 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:07.754996 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:12:07.755464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:07.755743 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:07.756120 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:12:07.756662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:07.757412 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:12:07.757702 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:07.757974 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:12:07.758424 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:07.758713 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:12:07.760171 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:12:07.767194 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:12:07.767515 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:12:07.767790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:07.768341 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:07.768624 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:12:07.768911 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:12:07.783008 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:12:07.784180 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:12:07.785138 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:12:07.785426 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:12:07.786443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA742000>]}
[0m13:12:07.786860 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:07.787140 [debug] [MainThread]: On master: BEGIN
[0m13:12:07.787402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:07.788004 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:07.788290 [debug] [MainThread]: On master: COMMIT
[0m13:12:07.788566 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:07.788843 [debug] [MainThread]: On master: COMMIT
[0m13:12:07.789324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:07.789607 [debug] [MainThread]: On master: Close
[0m13:12:07.793440 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:12:07.793908 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:12:07.794561 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:12:07.794903 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:12:07.800456 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:12:07.801214 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:12:07.872007 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:12:07.873041 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.873415 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:12:07.873737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:07.874710 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:07.875191 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.875530 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:12:07.876294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:07.881788 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.882175 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:12:07.882882 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:07.885837 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.886200 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:12:07.887013 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:07.898358 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:12:07.898924 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.899344 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:12:07.902276 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:07.907909 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:07.908602 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:12:07.910727 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:07.912968 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:12:07.914636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA556090>]}
[0m13:12:07.915576 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.12s]
[0m13:12:07.916585 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:12:07.916967 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:12:07.917402 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:12:07.918259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:12:07.918666 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:12:07.920211 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:07.920943 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:12:07.923989 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:07.924752 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:07.925100 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:12:07.925424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:07.926050 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:07.926386 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:07.926726 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:12:07.931689 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "appId"

LINE 6:     cast("appId" as varchar) as app_id,
                 ^
[0m13:12:07.932097 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:12:07.932461 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:12:07.932827 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:12:07.934705 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:12:07.935173 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:12:07.941519 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:12:07.942047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA744520>]}
[0m13:12:07.942624 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:12:07.943473 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:12:07.943930 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:07.945003 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^.
[0m13:12:07.944403 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:12:07.946204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:12:07.946568 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:07.949674 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.950990 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:07.955101 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.956044 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.956476 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:12:07.956853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:07.957521 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:07.957915 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.958294 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:12:07.963400 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:12:07.966316 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.966733 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:12:07.967494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:07.970626 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.971211 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:12:07.971992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:07.973536 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:12:07.973949 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.974317 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:12:07.976569 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:07.979167 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:07.979559 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:12:07.981716 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:07.983140 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:12:07.983644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2708ac46-c4b4-40f6-a676-5b3b10c72657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA0D3BB0>]}
[0m13:12:07.984201 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:12:07.985002 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:07.986248 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:07.986565 [debug] [MainThread]: On master: BEGIN
[0m13:12:07.986860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:07.987403 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:07.987694 [debug] [MainThread]: On master: COMMIT
[0m13:12:07.987974 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:07.988241 [debug] [MainThread]: On master: COMMIT
[0m13:12:07.988685 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:07.988973 [debug] [MainThread]: On master: Close
[0m13:12:07.989314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:07.989575 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:12:07.989830 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:12:07.990076 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:12:07.990405 [info ] [MainThread]: 
[0m13:12:07.990917 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:12:07.992009 [debug] [MainThread]: Command end result
[0m13:12:08.016110 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:12:08.018323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:12:08.024165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:12:08.024490 [info ] [MainThread]: 
[0m13:12:08.025005 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:08.025448 [info ] [MainThread]: 
[0m13:12:08.025964 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:12:08.026516 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:12:08.027020 [info ] [MainThread]: 
[0m13:12:08.027502 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:12:08.027963 [info ] [MainThread]: 
[0m13:12:08.028441 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:12:08.029326 [debug] [MainThread]: Command `dbt run` failed at 13:12:08.029215 after 1.33 seconds
[0m13:12:08.029681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA803BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ACA3E1C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC8A91780>]}
[0m13:12:08.030071 [debug] [MainThread]: Flushing usage events
[0m13:12:08.765877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:26.924756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB5324C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB665BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB665BB10>]}


============================== 13:12:26.928727 | 57773e69-91f7-4309-836f-abe54769f9fa ==============================
[0m13:12:26.928727 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:12:26.929385 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:12:27.159566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB597DA70>]}
[0m13:12:27.224298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB675D8C0>]}
[0m13:12:27.226428 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:12:27.455919 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:12:27.581399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:27.581761 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:12:27.582008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:27.587684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:12:27.622734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB7E7A450>]}
[0m13:12:27.692746 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:12:27.694814 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:12:27.712810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB77CCC80>]}
[0m13:12:27.713230 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:12:27.713769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB66BBD90>]}
[0m13:12:27.715618 [info ] [MainThread]: 
[0m13:12:27.716082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:27.716505 [info ] [MainThread]: 
[0m13:12:27.717085 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:27.721530 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:12:27.792744 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:12:27.793109 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:12:27.793448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:27.818960 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m13:12:27.820184 [debug] [ThreadPool]: On list_google_play: Close
[0m13:12:27.820820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:12:27.821238 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:12:27.826923 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:27.827229 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:12:27.827509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:27.828349 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:27.829436 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:27.829720 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:12:27.830168 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:27.830447 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:27.830732 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:12:27.831231 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:27.831962 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:12:27.832250 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:12:27.832526 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:12:27.832957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:12:27.833246 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:12:27.834593 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:12:27.841645 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:12:27.841992 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:12:27.842259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:27.842855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:27.843137 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:12:27.843420 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:12:27.858555 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:12:27.859815 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:12:27.860762 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:12:27.861059 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:12:27.862103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB82D2000>]}
[0m13:12:27.862519 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:27.862799 [debug] [MainThread]: On master: BEGIN
[0m13:12:27.863063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:27.863590 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:27.863874 [debug] [MainThread]: On master: COMMIT
[0m13:12:27.864148 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:27.864411 [debug] [MainThread]: On master: COMMIT
[0m13:12:27.864893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:27.865177 [debug] [MainThread]: On master: Close
[0m13:12:27.869048 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:12:27.869517 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:12:27.870244 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:12:27.870717 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:12:27.876262 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:12:27.877014 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:12:27.947626 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:12:27.948603 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.948972 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:12:27.949295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:27.950071 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:27.950452 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.950791 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:12:27.951598 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:27.957197 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.957560 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:12:27.958209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:27.961007 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.961379 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:12:27.962001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:27.973384 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:12:27.973762 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.974122 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:12:27.977237 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:27.982567 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:12:27.982927 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:12:27.984968 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:27.987111 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:12:27.988695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB80E2090>]}
[0m13:12:27.989275 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.12s]
[0m13:12:27.990049 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:12:27.990436 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:12:27.990861 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:12:27.991426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:12:27.991773 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:12:27.993211 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:27.993935 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:12:27.996775 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:27.997465 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:27.998176 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:12:27.998500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:27.999174 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:27.999648 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:12:27.999982 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:12:28.004666 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "appId" not found in FROM clause!
Candidate bindings: "appId"

LINE 6:     cast("appId" as varchar) as app_id,
                 ^
[0m13:12:28.005091 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast("appId" as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv')
  );

[0m13:12:28.005502 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:12:28.005949 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:12:28.009061 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:12:28.009555 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:12:28.016375 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:12:28.016905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB82D4520>]}
[0m13:12:28.017468 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.03s]
[0m13:12:28.018261 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:12:28.018657 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:28.019192 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^.
[0m13:12:28.019689 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:12:28.020770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:12:28.021111 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:28.022630 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.023477 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:28.027080 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.028039 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.028443 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:12:28.028933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:28.029846 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:28.030227 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.030614 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:12:28.034959 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:28.038048 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.038485 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:12:28.039236 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:28.041954 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.042338 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:12:28.043011 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:12:28.044521 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:12:28.044992 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.045351 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:12:28.047919 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:28.050325 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:12:28.050870 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:12:28.053357 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:12:28.054996 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:12:28.055479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57773e69-91f7-4309-836f-abe54769f9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB7C63BB0>]}
[0m13:12:28.056014 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.03s]
[0m13:12:28.056963 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:12:28.058164 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:28.058447 [debug] [MainThread]: On master: BEGIN
[0m13:12:28.058706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:28.059276 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:28.059552 [debug] [MainThread]: On master: COMMIT
[0m13:12:28.059830 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:28.060088 [debug] [MainThread]: On master: COMMIT
[0m13:12:28.060609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:12:28.060983 [debug] [MainThread]: On master: Close
[0m13:12:28.061331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:28.061611 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:12:28.061865 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:12:28.062101 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:12:28.062408 [info ] [MainThread]: 
[0m13:12:28.062834 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:12:28.064076 [debug] [MainThread]: Command end result
[0m13:12:28.090124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:12:28.092468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:12:28.098721 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:12:28.099084 [info ] [MainThread]: 
[0m13:12:28.099618 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:28.100232 [info ] [MainThread]: 
[0m13:12:28.100896 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:12:28.101459 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "appId" not found in FROM clause!
  Candidate bindings: "appId"
  
  LINE 6:     cast("appId" as varchar) as app_id,
                   ^
[0m13:12:28.101959 [info ] [MainThread]: 
[0m13:12:28.102458 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:12:28.102923 [info ] [MainThread]: 
[0m13:12:28.103423 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:12:28.104428 [debug] [MainThread]: Command `dbt run` failed at 13:12:28.104313 after 1.31 seconds
[0m13:12:28.104791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB7F718D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB7F71C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB6691780>]}
[0m13:12:28.105139 [debug] [MainThread]: Flushing usage events
[0m13:12:28.983214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:19.991478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501A814C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501BB4FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501BB4FB10>]}


============================== 13:14:19.995382 | 884ec1f9-557e-41fc-93fb-b91f4d60c53c ==============================
[0m13:14:19.995382 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:14:19.996027 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:14:20.242993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501AE6D940>]}
[0m13:14:20.304246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501BC4D8C0>]}
[0m13:14:20.306210 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:14:20.532488 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:14:20.680923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:14:20.681716 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:14:20.682070 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:14:21.076630 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:14:21.077294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D3C2450>]}
[0m13:14:21.144771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:14:21.149107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D436E40>]}
[0m13:14:21.219783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:14:21.221866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:14:21.240463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D71E6D0>]}
[0m13:14:21.240891 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:14:21.241349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D74DF30>]}
[0m13:14:21.243101 [info ] [MainThread]: 
[0m13:14:21.243568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:21.244022 [info ] [MainThread]: 
[0m13:14:21.244575 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:14:21.249015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:14:21.322308 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:14:21.322674 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:14:21.322963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:21.346916 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:14:21.348171 [debug] [ThreadPool]: On list_google_play: Close
[0m13:14:21.348841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:14:21.349314 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:14:21.354833 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:14:21.355140 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:14:21.355421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:21.356302 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:21.357414 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:14:21.357703 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:14:21.358156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:21.358437 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:14:21.358724 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:14:21.359226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:21.359968 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:14:21.360259 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:14:21.360541 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:14:21.360977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:14:21.361271 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:14:21.362701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:14:21.367743 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:14:21.368046 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:14:21.368320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:21.368853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:14:21.369136 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:14:21.369426 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:14:21.384949 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:14:21.386233 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:14:21.387181 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:14:21.387476 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:14:21.388537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D766990>]}
[0m13:14:21.388947 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:21.389227 [debug] [MainThread]: On master: BEGIN
[0m13:14:21.389490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:21.390051 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:14:21.390350 [debug] [MainThread]: On master: COMMIT
[0m13:14:21.390626 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:21.390888 [debug] [MainThread]: On master: COMMIT
[0m13:14:21.391371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:21.391655 [debug] [MainThread]: On master: Close
[0m13:14:21.395597 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:14:21.396078 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:14:21.396736 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:14:21.397081 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:14:21.402655 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:14:21.403391 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:14:21.431845 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:14:21.432729 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.433071 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:14:21.433397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:21.434154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:21.434483 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.434808 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:14:21.435614 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:21.440911 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.441268 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:14:21.441876 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:21.444667 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.445014 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:14:21.445604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:21.456372 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:14:21.456756 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.457101 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:14:21.460203 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:14:21.465396 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:14:21.465809 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:14:21.468208 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:21.470604 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:14:21.472324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501D80A570>]}
[0m13:14:21.472979 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.07s]
[0m13:14:21.473784 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:14:21.474181 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:14:21.474650 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:14:21.475238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:14:21.475634 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:14:21.477512 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:14:21.478295 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:14:21.481125 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:14:21.481902 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:14:21.482277 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:14:21.482630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:21.483309 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:21.483690 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:14:21.484085 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(column0 as varchar) as app_id,
    cast(column1 as varchar) as app_name,
    cast(column3 as float) as rating,
    cast(column6 as varchar) as category,
    cast(column2 as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', header=false, skip=1)
  );

[0m13:14:21.489024 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Binder Error: Referenced column "column1" not found in FROM clause!
Candidate bindings: "column0"

LINE 7:     cast(column1 as varchar) as app_name,
                 ^
[0m13:14:21.489475 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(column0 as varchar) as app_id,
    cast(column1 as varchar) as app_name,
    cast(column3 as float) as rating,
    cast(column6 as varchar) as category,
    cast(column2 as varchar) as developer_name
from read_csv_auto('raw_data/note_taking_ai_apps_updated.csv', header=false, skip=1)
  );

[0m13:14:21.489881 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:14:21.490234 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:14:21.492203 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:14:21.492707 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:14:21.499711 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "column0"
  
  LINE 7:     cast(column1 as varchar) as app_name,
                   ^
[0m13:14:21.500291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501DBE80F0>]}
[0m13:14:21.500962 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.03s]
[0m13:14:21.501875 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:14:21.502299 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:14:21.503324 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "column0"
  
  LINE 7:     cast(column1 as varchar) as app_name,
                   ^.
[0m13:14:21.502785 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:14:21.504555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:14:21.504964 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:14:21.507018 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.507930 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:14:21.511338 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.512484 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.512906 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:14:21.513269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:21.513981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:14:21.514412 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.514795 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:14:21.519186 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:14:21.522193 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.522581 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:14:21.523264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:21.526068 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.526452 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:14:21.527241 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:14:21.528721 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:14:21.529114 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.529437 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:14:21.531443 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:21.533697 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:14:21.534048 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:14:21.536030 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:14:21.537272 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:14:21.537754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '884ec1f9-557e-41fc-93fb-b91f4d60c53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501DC37550>]}
[0m13:14:21.538299 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.03s]
[0m13:14:21.539031 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:14:21.540290 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:21.540591 [debug] [MainThread]: On master: BEGIN
[0m13:14:21.540858 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:21.541421 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:14:21.541703 [debug] [MainThread]: On master: COMMIT
[0m13:14:21.541987 [debug] [MainThread]: Using duckdb connection "master"
[0m13:14:21.542251 [debug] [MainThread]: On master: COMMIT
[0m13:14:21.542751 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:14:21.543074 [debug] [MainThread]: On master: Close
[0m13:14:21.543425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:21.543687 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:14:21.543937 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:14:21.544182 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:14:21.544508 [info ] [MainThread]: 
[0m13:14:21.544947 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:14:21.546162 [debug] [MainThread]: Command end result
[0m13:14:21.570920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:14:21.573171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:14:21.579579 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:14:21.579953 [info ] [MainThread]: 
[0m13:14:21.580490 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:14:21.581044 [info ] [MainThread]: 
[0m13:14:21.581596 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:14:21.582178 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Binder Error: Referenced column "column1" not found in FROM clause!
  Candidate bindings: "column0"
  
  LINE 7:     cast(column1 as varchar) as app_name,
                   ^
[0m13:14:21.582691 [info ] [MainThread]: 
[0m13:14:21.583196 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:14:21.583634 [info ] [MainThread]: 
[0m13:14:21.584220 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:14:21.585102 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:14:21.586321 [debug] [MainThread]: Command `dbt run` failed at 13:14:21.586198 after 1.73 seconds
[0m13:14:21.586695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501BB81780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250153642F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501AE1A8D0>]}
[0m13:14:21.587051 [debug] [MainThread]: Flushing usage events
[0m13:14:22.471017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:30.056454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019244274C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192455ABED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192455ABB10>]}


============================== 13:15:30.060389 | 6e72671d-5126-4e77-bd1f-8883feb55830 ==============================
[0m13:15:30.060389 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:15:30.061057 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:15:30.296443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192448CDA70>]}
[0m13:15:30.366721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192456A58C0>]}
[0m13:15:30.369146 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:15:30.596417 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:15:30.744393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:30.745093 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:15:30.745413 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:15:31.144795 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:15:31.145489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019246DFE450>]}
[0m13:15:31.223381 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:15:31.228089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019246E72E40>]}
[0m13:15:31.299629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:15:31.301823 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:15:31.320263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924715E6D0>]}
[0m13:15:31.320708 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:15:31.321218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019247175F30>]}
[0m13:15:31.323013 [info ] [MainThread]: 
[0m13:15:31.323491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:31.323950 [info ] [MainThread]: 
[0m13:15:31.324565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:15:31.329239 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:15:31.402450 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:15:31.402847 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:15:31.403181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:31.427504 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:15:31.428733 [debug] [ThreadPool]: On list_google_play: Close
[0m13:15:31.429412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:15:31.429836 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:15:31.435601 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:15:31.435916 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:15:31.436198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:31.437016 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:15:31.438164 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:15:31.438495 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:15:31.438950 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:31.439246 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:15:31.439523 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:15:31.440073 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:31.440881 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:15:31.441182 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:15:31.441455 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:15:31.441894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:15:31.442184 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:15:31.443606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:15:31.448769 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:15:31.449092 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:15:31.449436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:31.449989 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:15:31.450273 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:15:31.450564 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:15:31.465766 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:15:31.467043 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:15:31.468111 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:15:31.468400 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:15:31.469445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192471A6990>]}
[0m13:15:31.469856 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.470137 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.470401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:31.470914 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:15:31.471208 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.471484 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.471749 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.472231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:15:31.472515 [debug] [MainThread]: On master: Close
[0m13:15:31.476331 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:15:31.476806 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:15:31.477464 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:15:31.477819 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:15:31.483734 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:15:31.484514 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:15:31.513635 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:15:31.514763 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.515292 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:15:31.515616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:31.516417 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:31.516756 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.517086 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:15:31.517813 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:31.523314 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.523685 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:15:31.524357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:31.527209 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.527565 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:15:31.528170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:31.539132 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:15:31.539534 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.539858 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:15:31.542865 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:15:31.547805 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:15:31.548235 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:15:31.550299 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:15:31.552479 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:15:31.554037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924724A570>]}
[0m13:15:31.554617 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:15:31.555435 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:15:31.555820 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:15:31.556263 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:15:31.556814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:15:31.557158 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:15:31.559069 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:15:31.560021 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:15:31.563034 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:15:31.564121 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:15:31.564487 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:15:31.564809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:31.565444 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:31.565778 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:15:31.566254 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',', normalize_names=true)
  );

[0m13:15:31.570840 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
It was not possible to automatically detect the CSV parsing dialect
The search space used was:
Delimiter Candidates: ','
Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
Comment Candidates: '\0', '#'
Encoding: utf-8
Possible fixes:
* Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
* Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
* Delimiter is set to ','. Consider unsetting it.
* Set quote (e.g., quote='"')
* Set escape (e.g., escape='"')
* Set comment (e.g., comment='#')
* Set skip (skip=${n}) to skip ${n} lines at the top of the file
* Enable ignore errors (ignore_errors=true) to ignore potential errors
* Enable null padding (null_padding=true) to pad missing columns with NULL values
* Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
* Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)


LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
              ^
[0m13:15:31.571351 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',', normalize_names=true)
  );

[0m13:15:31.571710 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:15:31.572087 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:15:31.574078 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:15:31.574523 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:15:31.581053 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:15:31.581613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192476240F0>]}
[0m13:15:31.582324 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:15:31.583184 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:15:31.583607 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:15:31.584679 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^.
[0m13:15:31.584087 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:15:31.585969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:15:31.586352 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:15:31.588801 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.589913 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:15:31.593141 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.594214 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.594626 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:15:31.594990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:31.595727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:15:31.596119 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.596509 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:15:31.602290 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:15:31.605591 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.606046 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:15:31.606791 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:31.609712 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.610147 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:15:31.610895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:15:31.612434 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:15:31.612844 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.613226 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:15:31.615512 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:15:31.618217 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:15:31.618621 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:15:31.620797 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:15:31.622143 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:15:31.622650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e72671d-5126-4e77-bd1f-8883feb55830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019247677550>]}
[0m13:15:31.623216 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:15:31.623940 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:15:31.625153 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.625458 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.625733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:31.626331 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:15:31.626625 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.626911 [debug] [MainThread]: Using duckdb connection "master"
[0m13:15:31.627184 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.627637 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:15:31.627944 [debug] [MainThread]: On master: Close
[0m13:15:31.628297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:31.628564 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:15:31.628817 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:15:31.629068 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:15:31.629390 [info ] [MainThread]: 
[0m13:15:31.629878 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:15:31.631097 [debug] [MainThread]: Command end result
[0m13:15:31.672050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:15:31.675065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:15:31.682343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:15:31.682715 [info ] [MainThread]: 
[0m13:15:31.683234 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:31.683717 [info ] [MainThread]: 
[0m13:15:31.684255 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:15:31.684849 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:15:31.685487 [info ] [MainThread]: 
[0m13:15:31.685966 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:15:31.686398 [info ] [MainThread]: 
[0m13:15:31.686890 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:15:31.687779 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:15:31.689259 [debug] [MainThread]: Command `dbt run` failed at 13:15:31.689071 after 1.78 seconds
[0m13:15:31.689801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192455E5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923EDF42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924273F7D0>]}
[0m13:15:31.690348 [debug] [MainThread]: Flushing usage events
[0m13:15:32.628877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:19.318800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A6914C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A7C4BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A7C4BB10>]}


============================== 13:23:19.322760 | 3b859534-ade0-4fbe-bbd8-85f42500652c ==============================
[0m13:23:19.322760 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:23:19.323464 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:23:19.557071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A6F6D940>]}
[0m13:23:19.631300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A7D398C0>]}
[0m13:23:19.633946 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:23:19.865627 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:23:20.006787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:20.007134 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:23:20.007390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:20.016084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:23:20.049107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A947E450>]}
[0m13:23:20.119193 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:23:20.121278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:23:20.138996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A913CC80>]}
[0m13:23:20.139483 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:23:20.139993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A7CABD90>]}
[0m13:23:20.141806 [info ] [MainThread]: 
[0m13:23:20.142269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:20.142657 [info ] [MainThread]: 
[0m13:23:20.143194 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:23:20.147639 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:23:20.221184 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:23:20.221554 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:23:20.221898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:20.237434 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:23:20.238679 [debug] [ThreadPool]: On list_google_play: Close
[0m13:23:20.239323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:23:20.239791 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:23:20.245487 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:23:20.245797 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:23:20.246077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:20.247023 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:23:20.248129 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:23:20.248423 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:23:20.248884 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:23:20.249164 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:23:20.249446 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:23:20.249952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:23:20.250954 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:23:20.251250 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:23:20.251532 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:23:20.252022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:23:20.252313 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:23:20.253770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:23:20.260916 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:23:20.261293 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:23:20.261592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:20.262221 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:23:20.262507 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:23:20.262795 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:23:20.277893 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:23:20.279170 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:23:20.280125 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:23:20.280421 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:23:20.281483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A98D2000>]}
[0m13:23:20.281887 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:20.282241 [debug] [MainThread]: On master: BEGIN
[0m13:23:20.282548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:23:20.283242 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:23:20.283786 [debug] [MainThread]: On master: COMMIT
[0m13:23:20.284228 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:20.284573 [debug] [MainThread]: On master: COMMIT
[0m13:23:20.285060 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:23:20.285347 [debug] [MainThread]: On master: Close
[0m13:23:20.289230 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:23:20.289727 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:23:20.290370 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:23:20.290786 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:23:20.296360 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:23:20.297120 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:23:20.376949 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:23:20.377834 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.378192 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:23:20.378516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:20.379321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:23:20.379663 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.380000 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:23:20.380806 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:20.386187 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.386560 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:23:20.387337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:20.390270 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.390649 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:23:20.391435 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:20.403670 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:23:20.404132 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.404507 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:23:20.407501 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:23:20.413144 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:23:20.413563 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:23:20.415743 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:23:20.418131 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:23:20.419815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A96E6090>]}
[0m13:23:20.420444 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.13s]
[0m13:23:20.421275 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:23:20.421709 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:23:20.422196 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:23:20.422853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:23:20.423243 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:23:20.425015 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:23:20.425843 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:23:20.429000 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:23:20.429814 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:23:20.430180 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:23:20.430525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:20.431160 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:23:20.431501 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:23:20.431849 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',', normalize_names=true)
  );

[0m13:23:20.435519 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
It was not possible to automatically detect the CSV parsing dialect
The search space used was:
Delimiter Candidates: ','
Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
Comment Candidates: '\0', '#'
Encoding: utf-8
Possible fixes:
* Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
* Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
* Delimiter is set to ','. Consider unsetting it.
* Set quote (e.g., quote='"')
* Set escape (e.g., escape='"')
* Set comment (e.g., comment='#')
* Set skip (skip=${n}) to skip ${n} lines at the top of the file
* Enable ignore errors (ignore_errors=true) to ignore potential errors
* Enable null padding (null_padding=true) to pad missing columns with NULL values
* Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
* Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)


LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
              ^
[0m13:23:20.436036 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv('raw_data/note_taking_ai_apps_updated.csv', header=true, delim=',', normalize_names=true)
  );

[0m13:23:20.436433 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:23:20.436791 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: ROLLBACK
[0m13:23:20.438695 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_apps'
[0m13:23:20.439164 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:23:20.445983 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:23:20.446659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A98D4520>]}
[0m13:23:20.447324 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model main.stg_playstore_apps ................... [[31mERROR[0m in 0.02s]
[0m13:23:20.448265 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:23:20.448721 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:23:20.449893 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_apps' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^.
[0m13:23:20.449247 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:23:20.451331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:23:20.451741 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:23:20.453510 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.454765 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:23:20.459941 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.461205 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.461818 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:23:20.462387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:20.463422 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:23:20.463999 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.464585 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:23:20.471463 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:23:20.475172 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.475665 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:23:20.476453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:20.479188 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.479572 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:23:20.480279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:20.481670 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:23:20.482063 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.482401 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:23:20.485029 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:23:20.487874 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:23:20.488261 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:23:20.490326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:23:20.491654 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:23:20.492156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b859534-ade0-4fbe-bbd8-85f42500652c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A9263BB0>]}
[0m13:23:20.492721 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:23:20.493486 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:23:20.494590 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:20.494893 [debug] [MainThread]: On master: BEGIN
[0m13:23:20.495169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:20.495726 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:23:20.496017 [debug] [MainThread]: On master: COMMIT
[0m13:23:20.496308 [debug] [MainThread]: Using duckdb connection "master"
[0m13:23:20.496578 [debug] [MainThread]: On master: COMMIT
[0m13:23:20.497023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:23:20.497315 [debug] [MainThread]: On master: Close
[0m13:23:20.497666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:20.497932 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:23:20.498202 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:23:20.498452 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:23:20.498771 [info ] [MainThread]: 
[0m13:23:20.499263 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:23:20.500426 [debug] [MainThread]: Command end result
[0m13:23:20.524180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:23:20.526548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:23:20.532860 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:23:20.533283 [info ] [MainThread]: 
[0m13:23:20.533825 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:23:20.534325 [info ] [MainThread]: 
[0m13:23:20.534895 [error] [MainThread]: [31mFailure in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)[0m
[0m13:23:20.535536 [error] [MainThread]:   Runtime Error in model stg_playstore_apps (models\staging\stg_playstore_apps.sql)
  Invalid Input Error: Error when sniffing file "raw_data/note_taking_ai_apps_updated.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
  
  LINE 11: from read_csv('raw_data/note_taking_ai_apps_updated.csv', header...
                ^
[0m13:23:20.536224 [info ] [MainThread]: 
[0m13:23:20.536778 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_apps.sql
[0m13:23:20.537233 [info ] [MainThread]: 
[0m13:23:20.537731 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:23:20.538639 [debug] [MainThread]: Command `dbt run` failed at 13:23:20.538528 after 1.37 seconds
[0m13:23:20.539001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A95718D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A9571C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A7C81780>]}
[0m13:23:20.539352 [debug] [MainThread]: Flushing usage events
[0m13:23:21.488578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:23.412977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C9054C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CA397ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CA397B10>]}


============================== 13:25:23.416937 | df908759-5266-4315-8efa-9c8f6ee60f7b ==============================
[0m13:25:23.416937 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:25:23.417577 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:25:23.649321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C96BDA70>]}
[0m13:25:23.713612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CA4958C0>]}
[0m13:25:23.715796 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:25:23.936180 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:25:24.068699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:24.069369 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:25:24.069729 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:25:24.471224 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:25:24.471968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CBD3E450>]}
[0m13:25:24.541046 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:25:24.545460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CBDAEE40>]}
[0m13:25:24.616725 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:25:24.618853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:25:24.636954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC09E6D0>]}
[0m13:25:24.637379 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:25:24.637814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC0CDF30>]}
[0m13:25:24.639549 [info ] [MainThread]: 
[0m13:25:24.639966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:24.640336 [info ] [MainThread]: 
[0m13:25:24.640864 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:24.645804 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:25:24.717959 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:25:24.718338 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:25:24.718634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:24.734150 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:25:24.735397 [debug] [ThreadPool]: On list_google_play: Close
[0m13:25:24.736042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:25:24.736482 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:25:24.742141 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:25:24.742472 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:25:24.742754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:24.743637 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:24.744832 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:25:24.745126 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:25:24.745592 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:24.745881 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:25:24.746157 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:25:24.746666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:24.747443 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:25:24.747744 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:25:24.748017 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:25:24.748460 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:24.748754 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:25:24.750223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:25:24.755394 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:25:24.755712 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:25:24.755991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:24.756733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:24.757066 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:25:24.757357 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:25:24.771942 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:25:24.773214 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:25:24.774212 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:25:24.774508 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:25:24.775567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC19E990>]}
[0m13:25:24.775972 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:24.776251 [debug] [MainThread]: On master: BEGIN
[0m13:25:24.776555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:24.777101 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:24.777385 [debug] [MainThread]: On master: COMMIT
[0m13:25:24.777666 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:24.777933 [debug] [MainThread]: On master: COMMIT
[0m13:25:24.778435 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:24.778730 [debug] [MainThread]: On master: Close
[0m13:25:24.782544 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:25:24.783023 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:25:24.783683 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:25:24.784027 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:25:24.789685 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:25:24.790480 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:25:24.821957 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:25:24.822968 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.823363 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:25:24.823770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:24.824657 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:24.825041 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.825424 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:25:24.826297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.832383 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.832824 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:25:24.833600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.836969 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.837374 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:25:24.838100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.850540 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:25:24.850992 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.851371 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:25:24.854679 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:25:24.860220 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:25:24.860642 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:25:24.862920 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:25:24.865387 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:25:24.867201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC17E570>]}
[0m13:25:24.867828 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:25:24.868672 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:25:24.869093 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:25:24.869595 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:25:24.870250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:25:24.870633 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:25:24.872633 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.873364 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:25:24.876013 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.876725 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.877098 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:25:24.877412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:24.878073 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:24.878407 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.878749 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
  );

[0m13:25:24.883303 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:25:24.886302 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.886738 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:25:24.888075 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:24.889368 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:25:24.889730 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.890056 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:25:24.892440 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:25:24.894534 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:25:24.894937 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:25:24.895886 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.897172 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:25:24.897715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC56B930>]}
[0m13:25:24.898272 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.03s]
[0m13:25:24.899117 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:25:24.899495 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:25:24.899924 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:25:24.900544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:25:24.900936 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:25:24.903050 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.904188 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:25:24.907415 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.908232 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.908583 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:25:24.908904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:24.909571 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:24.909906 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.910261 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:25:24.915046 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:25:24.918354 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.919067 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:25:24.919950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.923057 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.923535 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:25:24.924317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:24.925850 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:25:24.926258 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.926635 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:25:24.929112 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:25:24.931741 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:25:24.932128 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:25:24.934225 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:25:24.935769 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:25:24.936327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df908759-5266-4315-8efa-9c8f6ee60f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CC3E0950>]}
[0m13:25:24.936926 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:25:24.937659 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:25:24.939027 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:24.939361 [debug] [MainThread]: On master: BEGIN
[0m13:25:24.939668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:24.940317 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:24.940683 [debug] [MainThread]: On master: COMMIT
[0m13:25:24.940966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:24.941235 [debug] [MainThread]: On master: COMMIT
[0m13:25:24.941785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:24.942083 [debug] [MainThread]: On master: Close
[0m13:25:24.942537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:24.942878 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:25:24.943142 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:25:24.943394 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:25:24.943719 [info ] [MainThread]: 
[0m13:25:24.944411 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:25:24.945722 [debug] [MainThread]: Command end result
[0m13:25:24.970142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:25:24.972328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:25:24.978593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:25:24.978993 [info ] [MainThread]: 
[0m13:25:24.979635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:24.980274 [info ] [MainThread]: 
[0m13:25:24.980846 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:25:24.981517 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:25:24.982657 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:24.982535 after 1.72 seconds
[0m13:25:24.983182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223CA3D5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C3B842F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223C9CCCD70>]}
[0m13:25:24.983700 [debug] [MainThread]: Flushing usage events
[0m13:25:25.868769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:38.804510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CB1E4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CC533ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CC533B10>]}


============================== 13:27:38.808614 | 95a52217-3284-424e-8887-ace3896c5b4c ==============================
[0m13:27:38.808614 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:27:38.809249 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt test --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:27:39.045041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CB84DA70>]}
[0m13:27:39.107824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CC6258C0>]}
[0m13:27:39.109922 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:27:39.365117 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:27:39.506485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:39.506846 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:27:39.507119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:39.513140 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:27:39.545180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CDDD6650>]}
[0m13:27:39.616909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:27:39.619070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:27:39.646011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CE049E50>]}
[0m13:27:39.646456 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:27:39.646957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CE0CD1D0>]}
[0m13:27:39.648799 [info ] [MainThread]: 
[0m13:27:39.649277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:27:39.649732 [info ] [MainThread]: 
[0m13:27:39.650340 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:39.654890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:27:39.775897 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:27:39.776268 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:27:39.776556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:39.791264 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:27:39.791656 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:27:39.791975 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:27:39.807190 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:27:39.808573 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:27:39.809555 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:27:39.809850 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:27:39.811085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a52217-3284-424e-8887-ace3896c5b4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CE30CFC0>]}
[0m13:27:39.811500 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:39.811781 [debug] [MainThread]: On master: BEGIN
[0m13:27:39.812047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:39.812578 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:39.812874 [debug] [MainThread]: On master: COMMIT
[0m13:27:39.813151 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:39.813412 [debug] [MainThread]: On master: COMMIT
[0m13:27:39.813845 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:39.814134 [debug] [MainThread]: On master: Close
[0m13:27:39.818282 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:27:39.818685 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_playstore_apps_app_id ........................... [RUN]
[0m13:27:39.819590 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:27:39.819950 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:27:39.834947 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:27:39.836647 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:27:39.854430 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:27:39.855697 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:27:39.856055 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: BEGIN
[0m13:27:39.856393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:39.857261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:39.857651 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:27:39.857997 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select app_id
from "google_play"."main"."stg_playstore_apps"
where app_id is null



  
  
      
    ) dbt_internal_test
[0m13:27:39.862577 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:27:39.866703 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: ROLLBACK
[0m13:27:39.867440 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:27:39.867785 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: Close
[0m13:27:39.868357 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_playstore_apps_app_id ................................. [[32mPASS[0m in 0.05s]
[0m13:27:39.869121 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:27:39.869505 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:27:39.869861 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_playstore_reviews_review_id ..................... [RUN]
[0m13:27:39.870448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38, now test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0)
[0m13:27:39.870798 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:27:39.874222 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:27:39.875100 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:27:39.877543 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:27:39.878396 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:27:39.878747 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: BEGIN
[0m13:27:39.879074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:39.879700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:39.880046 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:27:39.880508 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from "google_play"."main"."stg_playstore_reviews"
where review_id is null



  
  
      
    ) dbt_internal_test
[0m13:27:39.886026 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:27:39.887614 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: ROLLBACK
[0m13:27:39.888263 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0'
[0m13:27:39.888607 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: Close
[0m13:27:39.889167 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_playstore_reviews_review_id ........................... [[32mPASS[0m in 0.02s]
[0m13:27:39.890405 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:27:39.890941 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:27:39.891324 [info ] [Thread-1 (]: 3 of 5 START test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [RUN]
[0m13:27:39.892095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0, now test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182)
[0m13:27:39.892559 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:27:39.901925 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:27:39.903433 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:27:39.906327 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:27:39.907644 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:27:39.908127 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: BEGIN
[0m13:27:39.908467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:39.909128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:39.909478 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:27:39.909847 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select app_id as from_field
    from "google_play"."main"."stg_playstore_reviews"
    where app_id is not null
),

parent as (
    select app_id as to_field
    from "google_play"."main"."stg_playstore_apps"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:27:39.917070 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:27:39.918836 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: ROLLBACK
[0m13:27:39.919800 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182'
[0m13:27:39.920355 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: Close
[0m13:27:39.920958 [info ] [Thread-1 (]: 3 of 5 PASS relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [[32mPASS[0m in 0.03s]
[0m13:27:39.921760 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:27:39.922154 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:27:39.922514 [info ] [Thread-1 (]: 4 of 5 START test unique_stg_playstore_apps_app_id ............................. [RUN]
[0m13:27:39.923216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182, now test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7)
[0m13:27:39.923756 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:27:39.929545 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:27:39.930560 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:27:39.933077 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:27:39.934015 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:27:39.934397 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: BEGIN
[0m13:27:39.934748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:39.935415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:39.935846 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:27:39.936310 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    app_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_apps"
where app_id is not null
group by app_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:27:39.940747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:27:39.942367 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: ROLLBACK
[0m13:27:39.943015 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7'
[0m13:27:39.943459 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: Close
[0m13:27:39.944101 [error] [Thread-1 (]: 4 of 5 FAIL 1 unique_stg_playstore_apps_app_id ................................. [[31mFAIL 1[0m in 0.02s]
[0m13:27:39.944988 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:27:39.945450 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:27:39.945848 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_playstore_reviews_review_id ....................... [RUN]
[0m13:27:39.946501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7, now test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7)
[0m13:27:39.946927 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:27:39.950659 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:27:39.951557 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:27:39.953977 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:27:39.954899 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:27:39.955292 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: BEGIN
[0m13:27:39.955633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:39.956415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:27:39.956786 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:27:39.957175 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_reviews"
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:27:39.964170 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:27:39.965842 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: ROLLBACK
[0m13:27:39.966526 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7'
[0m13:27:39.966878 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: Close
[0m13:27:39.967488 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_playstore_reviews_review_id ............................. [[32mPASS[0m in 0.02s]
[0m13:27:39.968265 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:27:39.969733 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:39.970180 [debug] [MainThread]: On master: BEGIN
[0m13:27:39.970540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:39.971633 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:27:39.971993 [debug] [MainThread]: On master: COMMIT
[0m13:27:39.972307 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:39.972588 [debug] [MainThread]: On master: COMMIT
[0m13:27:39.973163 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:27:39.973495 [debug] [MainThread]: On master: Close
[0m13:27:39.973927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:39.974404 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:27:39.974796 [debug] [MainThread]: Connection 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7' was properly closed.
[0m13:27:39.975260 [info ] [MainThread]: 
[0m13:27:39.975828 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m13:27:39.977281 [debug] [MainThread]: Command end result
[0m13:27:40.003249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:27:40.005715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:27:40.013559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:27:40.013945 [info ] [MainThread]: 
[0m13:27:40.014512 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:27:40.015124 [info ] [MainThread]: 
[0m13:27:40.015744 [error] [MainThread]: [31mFailure in test unique_stg_playstore_apps_app_id (models\staging\schema.yml)[0m
[0m13:27:40.016326 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:27:40.016790 [info ] [MainThread]: 
[0m13:27:40.017343 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\schema.yml\unique_stg_playstore_apps_app_id.sql
[0m13:27:40.017823 [info ] [MainThread]: 
[0m13:27:40.018319 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m13:27:40.019434 [debug] [MainThread]: Command `dbt test` failed at 13:27:40.019245 after 1.36 seconds
[0m13:27:40.019996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CC36E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CE081BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6CE0817B0>]}
[0m13:27:40.020488 [debug] [MainThread]: Flushing usage events
[0m13:27:40.930430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:26.856028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021913AA4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021914DDFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021914DDFB10>]}


============================== 13:29:26.863115 | eb7d3f97-be51-4a22-a2f6-858c8129ca50 ==============================
[0m13:29:26.863115 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:29:26.864433 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:29:27.127734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219140F5A70>]}
[0m13:29:27.192782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021915EA98C0>]}
[0m13:29:27.194987 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:29:27.429017 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:29:27.565693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:29:27.566408 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:29:27.566751 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:29:27.970165 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:29:27.970841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002191665E450>]}
[0m13:29:28.043404 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:29:28.048584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219166CEE40>]}
[0m13:29:28.124645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:29:28.126983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:29:28.147452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219169BE6D0>]}
[0m13:29:28.147988 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:29:28.148526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219169EDF30>]}
[0m13:29:28.150481 [info ] [MainThread]: 
[0m13:29:28.151018 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:28.151470 [info ] [MainThread]: 
[0m13:29:28.152106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:29:28.157728 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:29:28.237850 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:29:28.238248 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:29:28.238554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:28.255816 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:29:28.257307 [debug] [ThreadPool]: On list_google_play: Close
[0m13:29:28.258226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:29:28.258672 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:29:28.264984 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:29:28.265566 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:29:28.265961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:28.266970 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:28.268184 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:29:28.268489 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:29:28.269010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:28.269404 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:29:28.269718 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:29:28.270527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:28.271381 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:29:28.271693 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:29:28.271979 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:29:28.272518 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:29:28.272838 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:29:28.274760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:29:28.280863 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:29:28.281300 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:29:28.281646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:28.282495 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:29:28.282913 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:29:28.283215 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:29:28.299005 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:29:28.300584 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:29:28.301584 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:29:28.301893 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:29:28.303263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021916A02990>]}
[0m13:29:28.303728 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:28.304019 [debug] [MainThread]: On master: BEGIN
[0m13:29:28.304297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:28.304889 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:28.305193 [debug] [MainThread]: On master: COMMIT
[0m13:29:28.305478 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:28.305752 [debug] [MainThread]: On master: COMMIT
[0m13:29:28.306397 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:28.306840 [debug] [MainThread]: On master: Close
[0m13:29:28.311420 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:29:28.312021 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:29:28.312758 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:29:28.313123 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:29:28.319155 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:29:28.320063 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:29:28.351391 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:29:28.352480 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.352920 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:29:28.353251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:28.354087 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:28.354437 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.354795 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:29:28.355569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.361500 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.361936 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:29:28.362684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.366077 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.366566 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:29:28.367298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.379405 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:29:28.379838 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.380172 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:29:28.383268 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:29:28.389178 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:29:28.389883 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:29:28.392135 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:29:28.394680 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:29:28.396423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021916AAE570>]}
[0m13:29:28.397017 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:29:28.397916 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:29:28.398394 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:29:28.398938 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:29:28.399602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:29:28.399963 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:29:28.402132 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.403091 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:29:28.406354 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.407974 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.408383 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:29:28.408718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:28.409403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:28.409806 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.410412 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- This line removes duplicates by keeping the row with the highest rating for each app_id
qualify row_number() over (partition by app_id order by rating desc) = 1
  );

[0m13:29:28.416033 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:29:28.419391 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.419875 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:29:28.420595 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.423862 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.424345 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:29:28.425142 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.426740 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:29:28.427295 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.427682 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:29:28.430403 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:29:28.433936 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:29:28.434424 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:29:28.436911 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:29:28.438485 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:29:28.439105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021916E85A90>]}
[0m13:29:28.439883 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.04s]
[0m13:29:28.440767 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:29:28.441210 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:29:28.441759 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:29:28.442379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:29:28.442777 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:29:28.444672 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.445588 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:29:28.449241 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.450204 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.450628 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:29:28.451019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:28.451873 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:28.452303 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.452752 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:29:28.457975 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:29:28.460904 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.461347 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:29:28.462130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.465285 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.465716 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:29:28.466449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:29:28.467849 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:29:28.468212 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.468553 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:29:28.470686 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:29:28.472919 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:29:28.473310 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:29:28.475771 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:29:28.477223 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:29:28.477869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb7d3f97-be51-4a22-a2f6-858c8129ca50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021916D0E0D0>]}
[0m13:29:28.478514 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:29:28.479276 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:29:28.480510 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:28.480824 [debug] [MainThread]: On master: BEGIN
[0m13:29:28.481107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:28.481698 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:28.482011 [debug] [MainThread]: On master: COMMIT
[0m13:29:28.482329 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:28.482610 [debug] [MainThread]: On master: COMMIT
[0m13:29:28.483092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:28.483394 [debug] [MainThread]: On master: Close
[0m13:29:28.483763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:28.484046 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:29:28.484307 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:29:28.484569 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:29:28.484908 [info ] [MainThread]: 
[0m13:29:28.485448 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m13:29:28.486650 [debug] [MainThread]: Command end result
[0m13:29:28.514707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:29:28.517187 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:29:28.523586 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:29:28.523978 [info ] [MainThread]: 
[0m13:29:28.524564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:28.525164 [info ] [MainThread]: 
[0m13:29:28.525792 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:29:28.526429 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:29:28.527565 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:28.527382 after 1.85 seconds
[0m13:29:28.528018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021915DE1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190E5D42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021911F6F4D0>]}
[0m13:29:28.528431 [debug] [MainThread]: Flushing usage events
[0m13:29:29.443079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:38.475139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF27D04C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF29037ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF29037B10>]}


============================== 13:29:38.479049 | 2ae08732-43f7-479c-a87a-d955c8598eef ==============================
[0m13:29:38.479049 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:29:38.479715 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:29:38.708906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2835DA70>]}
[0m13:29:38.776592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2913D8C0>]}
[0m13:29:38.778930 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:29:39.006154 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:29:39.163381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:39.163798 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:29:39.164124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:39.170872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:29:39.205435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2A832650>]}
[0m13:29:39.280736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:29:39.282781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:29:39.308349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2AAA9E50>]}
[0m13:29:39.308774 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:29:39.309304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2AB2D1D0>]}
[0m13:29:39.311414 [info ] [MainThread]: 
[0m13:29:39.311899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:39.312328 [info ] [MainThread]: 
[0m13:29:39.312882 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:29:39.317352 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:29:39.436365 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:29:39.436732 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:29:39.437012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:39.462963 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:29:39.463340 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:29:39.463646 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:29:39.479128 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:29:39.480428 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:29:39.481417 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:29:39.481713 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:29:39.482959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ae08732-43f7-479c-a87a-d955c8598eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2AD6CFC0>]}
[0m13:29:39.483459 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:39.483743 [debug] [MainThread]: On master: BEGIN
[0m13:29:39.484057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:39.484631 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:39.484920 [debug] [MainThread]: On master: COMMIT
[0m13:29:39.485205 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:39.485470 [debug] [MainThread]: On master: COMMIT
[0m13:29:39.485907 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:39.486202 [debug] [MainThread]: On master: Close
[0m13:29:39.490156 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:29:39.490552 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_playstore_apps_app_id ........................... [RUN]
[0m13:29:39.491226 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:29:39.491576 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:29:39.506746 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:29:39.507650 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:29:39.524031 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:29:39.524937 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:29:39.525293 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: BEGIN
[0m13:29:39.525620 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:39.526439 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:39.526793 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:29:39.527142 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select app_id
from "google_play"."main"."stg_playstore_apps"
where app_id is null



  
  
      
    ) dbt_internal_test
[0m13:29:39.532344 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:29:39.536316 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: ROLLBACK
[0m13:29:39.537016 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:29:39.537392 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: Close
[0m13:29:39.537931 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_playstore_apps_app_id ................................. [[32mPASS[0m in 0.05s]
[0m13:29:39.538693 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:29:39.539073 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:29:39.539427 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_playstore_reviews_review_id ..................... [RUN]
[0m13:29:39.540007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38, now test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0)
[0m13:29:39.540358 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:29:39.543746 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:29:39.544551 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:29:39.547159 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:29:39.548149 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:29:39.548530 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: BEGIN
[0m13:29:39.548853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:39.549524 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:39.549887 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:29:39.550320 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from "google_play"."main"."stg_playstore_reviews"
where review_id is null



  
  
      
    ) dbt_internal_test
[0m13:29:39.555070 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:29:39.556754 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: ROLLBACK
[0m13:29:39.557393 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0'
[0m13:29:39.557731 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: Close
[0m13:29:39.558277 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_playstore_reviews_review_id ........................... [[32mPASS[0m in 0.02s]
[0m13:29:39.559034 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:29:39.559463 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:29:39.559925 [info ] [Thread-1 (]: 3 of 5 START test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [RUN]
[0m13:29:39.560970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0, now test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182)
[0m13:29:39.561665 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:29:39.570758 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:29:39.571770 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:29:39.575035 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:29:39.575975 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:29:39.576350 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: BEGIN
[0m13:29:39.576680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:39.577321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:39.577666 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:29:39.578039 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select app_id as from_field
    from "google_play"."main"."stg_playstore_reviews"
    where app_id is not null
),

parent as (
    select app_id as to_field
    from "google_play"."main"."stg_playstore_apps"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:29:39.585724 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.586184 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select app_id as from_field
    from "google_play"."main"."stg_playstore_reviews"
    where app_id is not null
),

parent as (
    select app_id as to_field
    from "google_play"."main"."stg_playstore_apps"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:29:39.586568 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:29:39.586912 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: ROLLBACK
[0m13:29:39.588782 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182'
[0m13:29:39.589287 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: Close
[0m13:29:39.595945 [debug] [Thread-1 (]: Runtime Error in test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_ (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.596495 [error] [Thread-1 (]: 3 of 5 ERROR relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [[31mERROR[0m in 0.04s]
[0m13:29:39.597239 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:29:39.597624 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:29:39.598529 [debug] [Thread-4 (]: Marking all children of 'test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_ (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score.
[0m13:29:39.598020 [info ] [Thread-1 (]: 4 of 5 START test unique_stg_playstore_apps_app_id ............................. [RUN]
[0m13:29:39.599703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182, now test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7)
[0m13:29:39.600101 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:29:39.605840 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:29:39.606688 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:29:39.609093 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:29:39.610036 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:29:39.610447 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: BEGIN
[0m13:29:39.610779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:39.611436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:39.611780 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:29:39.612134 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    app_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_apps"
where app_id is not null
group by app_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:29:39.615417 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.615868 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    app_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_apps"
where app_id is not null
group by app_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:29:39.616236 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:29:39.616574 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: ROLLBACK
[0m13:29:39.617875 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7'
[0m13:29:39.618340 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: Close
[0m13:29:39.622506 [debug] [Thread-1 (]: Runtime Error in test unique_stg_playstore_apps_app_id (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.623031 [error] [Thread-1 (]: 4 of 5 ERROR unique_stg_playstore_apps_app_id .................................. [[31mERROR[0m in 0.02s]
[0m13:29:39.623736 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:29:39.624117 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:29:39.624988 [debug] [Thread-4 (]: Marking all children of 'test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_playstore_apps_app_id (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score.
[0m13:29:39.624475 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_playstore_reviews_review_id ....................... [RUN]
[0m13:29:39.625650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7, now test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7)
[0m13:29:39.626009 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:29:39.629605 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:29:39.630672 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:29:39.633169 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:29:39.634030 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:29:39.634398 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: BEGIN
[0m13:29:39.634731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:39.635408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:29:39.635764 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:29:39.636125 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_reviews"
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:29:39.642072 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:29:39.643729 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: ROLLBACK
[0m13:29:39.644394 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7'
[0m13:29:39.644741 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: Close
[0m13:29:39.645293 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_playstore_reviews_review_id ............................. [[32mPASS[0m in 0.02s]
[0m13:29:39.646048 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:29:39.647211 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:39.647592 [debug] [MainThread]: On master: BEGIN
[0m13:29:39.647882 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:39.648657 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:29:39.649130 [debug] [MainThread]: On master: COMMIT
[0m13:29:39.649426 [debug] [MainThread]: Using duckdb connection "master"
[0m13:29:39.649702 [debug] [MainThread]: On master: COMMIT
[0m13:29:39.650188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:29:39.650488 [debug] [MainThread]: On master: Close
[0m13:29:39.650875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:39.651143 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:29:39.651398 [debug] [MainThread]: Connection 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7' was properly closed.
[0m13:29:39.651733 [info ] [MainThread]: 
[0m13:29:39.652162 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:29:39.653716 [debug] [MainThread]: Command end result
[0m13:29:39.679275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:29:39.682310 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:29:39.689629 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:29:39.690032 [info ] [MainThread]: 
[0m13:29:39.690734 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:29:39.691268 [info ] [MainThread]: 
[0m13:29:39.691859 [error] [MainThread]: [31mFailure in test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_ (models\staging\schema.yml)[0m
[0m13:29:39.692432 [error] [MainThread]:   Runtime Error in test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_ (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.692926 [info ] [MainThread]: 
[0m13:29:39.693433 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\schema.yml\relationships_stg_playstore_re_0076b11ffcb20b3b9db3aede5a54cb1b.sql
[0m13:29:39.693908 [info ] [MainThread]: 
[0m13:29:39.694431 [error] [MainThread]: [31mFailure in test unique_stg_playstore_apps_app_id (models\staging\schema.yml)[0m
[0m13:29:39.694973 [error] [MainThread]:   Runtime Error in test unique_stg_playstore_apps_app_id (models\staging\schema.yml)
  Conversion Error: Could not convert string ' ' to FLOAT when casting from source column score
[0m13:29:39.695422 [info ] [MainThread]: 
[0m13:29:39.695918 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\schema.yml\unique_stg_playstore_apps_app_id.sql
[0m13:29:39.696412 [info ] [MainThread]: 
[0m13:29:39.696935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m13:29:39.697829 [debug] [MainThread]: Command `dbt test` failed at 13:29:39.697701 after 1.36 seconds
[0m13:29:39.698214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF28E82150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2AAE7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2AAE57B0>]}
[0m13:29:39.698578 [debug] [MainThread]: Flushing usage events
[0m13:29:40.444406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:14.692955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E7444C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E878FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E878FB10>]}


============================== 13:31:14.696899 | 389754e8-93b3-49b7-92cd-d7d19b9bf72a ==============================
[0m13:31:14.696899 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:31:14.697597 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:31:14.927902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E7AAD940>]}
[0m13:31:14.991604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E98518C0>]}
[0m13:31:14.993795 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:31:15.224838 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:31:15.376988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:31:15.377648 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:31:15.377950 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_apps.sql
[0m13:31:15.779414 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:31:15.780166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA02E450>]}
[0m13:31:15.851450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:31:15.856669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA09EE40>]}
[0m13:31:15.928864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:31:15.931016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:31:15.949394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA38E6D0>]}
[0m13:31:15.949834 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:31:15.950323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA3BDF30>]}
[0m13:31:15.952093 [info ] [MainThread]: 
[0m13:31:15.952585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:15.953040 [info ] [MainThread]: 
[0m13:31:15.953642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:31:15.958148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:31:16.032046 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:31:16.032446 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:31:16.032800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:16.048379 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:31:16.049635 [debug] [ThreadPool]: On list_google_play: Close
[0m13:31:16.050277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:31:16.050707 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:31:16.056315 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:31:16.056628 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:31:16.056911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:16.057794 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:16.058898 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:31:16.059188 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:31:16.059766 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:16.060064 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:31:16.060343 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:31:16.060854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:16.061604 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:31:16.061896 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:31:16.062178 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:31:16.062640 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:31:16.062937 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:31:16.064403 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:31:16.069383 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:31:16.069691 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:31:16.069963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:16.070501 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:31:16.070786 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:31:16.071075 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:31:16.085487 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:31:16.086784 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:31:16.087836 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:31:16.088124 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:31:16.089345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA48E990>]}
[0m13:31:16.089759 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:16.090043 [debug] [MainThread]: On master: BEGIN
[0m13:31:16.090308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:16.091175 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:16.091472 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.091759 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:16.092024 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.092626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:16.093068 [debug] [MainThread]: On master: Close
[0m13:31:16.097094 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:31:16.097615 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:31:16.098276 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:31:16.098623 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:31:16.104249 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:31:16.105031 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:31:16.136584 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:31:16.137578 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.137957 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:31:16.138334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:31:16.139241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:16.139622 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.139984 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:31:16.140823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.146624 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.147034 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:31:16.147762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.150812 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.151216 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:31:16.151892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.163958 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:31:16.164402 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.164772 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:31:16.167737 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:31:16.172845 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:31:16.173231 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:31:16.175404 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:31:16.177806 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:31:16.179431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA472570>]}
[0m13:31:16.180011 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:31:16.180821 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:31:16.181209 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:31:16.181650 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:31:16.182171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:31:16.182515 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:31:16.184337 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.185164 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:31:16.188263 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.189394 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.189812 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:31:16.190146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:16.190820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:16.191163 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.191518 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    try_cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- Keeps the unique app by prioritizing the highest rating (and puts NULLs at the bottom)
qualify row_number() over (partition by app_id order by try_cast(score as float) desc nulls last) = 1
  );

[0m13:31:16.196312 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:31:16.199787 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.200184 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:31:16.200881 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.204077 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.204452 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:31:16.205097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.206494 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:31:16.206847 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.207173 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:31:16.209580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:31:16.212152 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:31:16.212527 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:31:16.214483 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:31:16.215688 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:31:16.216175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA855A90>]}
[0m13:31:16.216733 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.03s]
[0m13:31:16.217611 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:31:16.218193 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:31:16.218643 [info ] [Thread-1 (]: 3 of 3 START sql view model main.stg_playstore_reviews ......................... [RUN]
[0m13:31:16.219264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:31:16.219627 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:31:16.221243 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.222182 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:31:16.225716 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.226754 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.227167 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:31:16.227700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:16.228402 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:16.228761 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.229124 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
  create view "google_play"."main"."stg_playstore_reviews__dbt_tmp" as (
    select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')
  );

[0m13:31:16.234022 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:31:16.237126 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.237575 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:31:16.238389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.241918 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.242428 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:31:16.243357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:31:16.245122 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:31:16.245581 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.245970 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:31:16.248692 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:31:16.251384 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:31:16.251819 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:31:16.254250 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:31:16.255717 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:31:16.256251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '389754e8-93b3-49b7-92cd-d7d19b9bf72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8EA6E20D0>]}
[0m13:31:16.256847 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.stg_playstore_reviews .................... [[32mOK[0m in 0.04s]
[0m13:31:16.257692 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:31:16.259199 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:16.259544 [debug] [MainThread]: On master: BEGIN
[0m13:31:16.259830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:16.260623 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:16.260989 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.261367 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:16.261675 [debug] [MainThread]: On master: COMMIT
[0m13:31:16.262314 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:16.262620 [debug] [MainThread]: On master: Close
[0m13:31:16.262993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:16.263254 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:31:16.263499 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:31:16.263807 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:31:16.264321 [info ] [MainThread]: 
[0m13:31:16.265057 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:31:16.266335 [debug] [MainThread]: Command end result
[0m13:31:16.295530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:31:16.298011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:31:16.304689 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:31:16.305097 [info ] [MainThread]: 
[0m13:31:16.305678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:16.306243 [info ] [MainThread]: 
[0m13:31:16.306794 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:31:16.307549 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:31:16.308595 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:16.308475 after 1.81 seconds
[0m13:31:16.308964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E978D780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E1FA42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8E85957F0>]}
[0m13:31:16.309328 [debug] [MainThread]: Flushing usage events
[0m13:31:17.207019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:27.847927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB8114C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB944BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB944BB10>]}


============================== 13:31:27.851841 | 48f94b62-e867-489a-8e1a-3cd6daa27493 ==============================
[0m13:31:27.851841 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:31:27.852480 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:31:28.082988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB876DA70>]}
[0m13:31:28.145229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB95398C0>]}
[0m13:31:28.147349 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:31:28.375544 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:31:28.512093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:28.512448 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:31:28.512732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:28.518648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:31:28.551632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABAC56650>]}
[0m13:31:28.622452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:31:28.624528 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:31:28.651732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABAEC9E50>]}
[0m13:31:28.652170 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:31:28.652665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABAF4D1D0>]}
[0m13:31:28.654479 [info ] [MainThread]: 
[0m13:31:28.654961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:28.655419 [info ] [MainThread]: 
[0m13:31:28.656025 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:31:28.660810 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:31:28.774544 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:31:28.774902 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:31:28.775174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:28.801201 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:31:28.801602 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:31:28.801912 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:31:28.816629 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:31:28.817933 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:31:28.819029 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:31:28.819331 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:31:28.820553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48f94b62-e867-489a-8e1a-3cd6daa27493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABB18CFC0>]}
[0m13:31:28.820966 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:28.821248 [debug] [MainThread]: On master: BEGIN
[0m13:31:28.821519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:28.822075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:28.822363 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.822650 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:28.822917 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.823359 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:28.823656 [debug] [MainThread]: On master: Close
[0m13:31:28.827638 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:31:28.828047 [info ] [Thread-1 (]: 1 of 5 START test not_null_stg_playstore_apps_app_id ........................... [RUN]
[0m13:31:28.828713 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:31:28.829057 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:31:28.844947 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:31:28.846020 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:31:28.863028 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:31:28.863996 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:31:28.864371 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: BEGIN
[0m13:31:28.864702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:31:28.865500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:28.865909 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:31:28.866257 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select app_id
from "google_play"."main"."stg_playstore_apps"
where app_id is null



  
  
      
    ) dbt_internal_test
[0m13:31:28.871574 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:31:28.875625 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: ROLLBACK
[0m13:31:28.876315 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38'
[0m13:31:28.876659 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38: Close
[0m13:31:28.877215 [info ] [Thread-1 (]: 1 of 5 PASS not_null_stg_playstore_apps_app_id ................................. [[32mPASS[0m in 0.05s]
[0m13:31:28.878024 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:31:28.878418 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:31:28.878793 [info ] [Thread-1 (]: 2 of 5 START test not_null_stg_playstore_reviews_review_id ..................... [RUN]
[0m13:31:28.879398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38, now test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0)
[0m13:31:28.879748 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:31:28.883811 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:31:28.884752 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:31:28.887289 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:31:28.888077 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:31:28.888426 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: BEGIN
[0m13:31:28.888752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:28.889392 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:28.889733 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:31:28.890074 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select review_id
from "google_play"."main"."stg_playstore_reviews"
where review_id is null



  
  
      
    ) dbt_internal_test
[0m13:31:28.894522 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:31:28.895942 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: ROLLBACK
[0m13:31:28.896535 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0'
[0m13:31:28.897111 [debug] [Thread-1 (]: On test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0: Close
[0m13:31:28.898028 [info ] [Thread-1 (]: 2 of 5 PASS not_null_stg_playstore_reviews_review_id ........................... [[32mPASS[0m in 0.02s]
[0m13:31:28.898901 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:31:28.899291 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:31:28.899652 [info ] [Thread-1 (]: 3 of 5 START test relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [RUN]
[0m13:31:28.900384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0, now test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182)
[0m13:31:28.900747 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:31:28.908466 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:31:28.909376 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:31:28.912421 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:31:28.914035 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:31:28.914628 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: BEGIN
[0m13:31:28.915033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:28.916375 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:28.917160 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:31:28.917705 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select app_id as from_field
    from "google_play"."main"."stg_playstore_reviews"
    where app_id is not null
),

parent as (
    select app_id as to_field
    from "google_play"."main"."stg_playstore_apps"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:31:28.931470 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:31:28.933503 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: ROLLBACK
[0m13:31:28.934141 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182'
[0m13:31:28.934492 [debug] [Thread-1 (]: On test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182: Close
[0m13:31:28.935061 [info ] [Thread-1 (]: 3 of 5 PASS relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_  [[32mPASS[0m in 0.03s]
[0m13:31:28.936081 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:31:28.936522 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:31:28.936921 [info ] [Thread-1 (]: 4 of 5 START test unique_stg_playstore_apps_app_id ............................. [RUN]
[0m13:31:28.937606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182, now test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7)
[0m13:31:28.937962 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:31:28.944075 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:31:28.945118 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:31:28.947837 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:31:28.948699 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:31:28.949110 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: BEGIN
[0m13:31:28.949437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:28.950208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:28.950662 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:31:28.951138 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    app_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_apps"
where app_id is not null
group by app_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:31:28.959256 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:31:28.961070 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: ROLLBACK
[0m13:31:28.961733 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7'
[0m13:31:28.962079 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7: Close
[0m13:31:28.962633 [info ] [Thread-1 (]: 4 of 5 PASS unique_stg_playstore_apps_app_id ................................... [[32mPASS[0m in 0.03s]
[0m13:31:28.963410 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:31:28.963920 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:31:28.964276 [info ] [Thread-1 (]: 5 of 5 START test unique_stg_playstore_reviews_review_id ....................... [RUN]
[0m13:31:28.965103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7, now test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7)
[0m13:31:28.965505 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:31:28.969752 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:31:28.970590 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:31:28.973178 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:31:28.973955 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:31:28.974346 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: BEGIN
[0m13:31:28.974686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:28.975316 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:31:28.975657 [debug] [Thread-1 (]: Using duckdb connection "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:31:28.976048 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    review_id as unique_field,
    count(*) as n_records

from "google_play"."main"."stg_playstore_reviews"
where review_id is not null
group by review_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:31:28.982666 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:31:28.984232 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: ROLLBACK
[0m13:31:28.985054 [debug] [Thread-1 (]: Failed to rollback 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7'
[0m13:31:28.985489 [debug] [Thread-1 (]: On test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7: Close
[0m13:31:28.986193 [info ] [Thread-1 (]: 5 of 5 PASS unique_stg_playstore_reviews_review_id ............................. [[32mPASS[0m in 0.02s]
[0m13:31:28.987217 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:31:28.988719 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:28.989098 [debug] [MainThread]: On master: BEGIN
[0m13:31:28.989489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:28.990282 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:31:28.990593 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.990874 [debug] [MainThread]: Using duckdb connection "master"
[0m13:31:28.991139 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.991622 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:31:28.991909 [debug] [MainThread]: On master: Close
[0m13:31:28.992282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:28.992540 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:31:28.992816 [debug] [MainThread]: Connection 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7' was properly closed.
[0m13:31:28.993383 [info ] [MainThread]: 
[0m13:31:28.994117 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:31:28.996113 [debug] [MainThread]: Command end result
[0m13:31:29.021075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:31:29.023611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:31:29.030754 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:31:29.031121 [info ] [MainThread]: 
[0m13:31:29.031660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:29.032136 [info ] [MainThread]: 
[0m13:31:29.032656 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m13:31:29.033646 [debug] [MainThread]: Command `dbt test` succeeded at 13:31:29.033522 after 1.32 seconds
[0m13:31:29.033999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB9292150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABAF05BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ABAF057B0>]}
[0m13:31:29.034352 [debug] [MainThread]: Flushing usage events
[0m13:31:29.813870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:13.703360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE6324C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE7647ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE7647B10>]}


============================== 13:43:13.707320 | 279e67c7-7c65-43c9-9ce4-19177cc804a9 ==============================
[0m13:43:13.707320 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:43:13.707985 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:43:13.953175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE6975940>]}
[0m13:43:14.014698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE77598C0>]}
[0m13:43:14.016684 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:43:14.255721 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:43:14.393325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:14.393684 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:43:14.393950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:14.399660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:43:14.432191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE8FB6650>]}
[0m13:43:14.451582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE907C050>]}
[0m13:43:14.452016 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:43:14.452524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE763E890>]}
[0m13:43:14.454363 [info ] [MainThread]: 
[0m13:43:14.454845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:14.455305 [info ] [MainThread]: 
[0m13:43:14.455918 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:14.460360 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:43:14.535718 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:43:14.536091 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:43:14.536378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:14.551152 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:43:14.551534 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:43:14.551845 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:43:14.566883 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:43:14.568216 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:43:14.569234 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:43:14.569539 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:43:14.570819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279e67c7-7c65-43c9-9ce4-19177cc804a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE9357860>]}
[0m13:43:14.574853 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:43:14.575335 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:43:14.575688 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:43:14.581417 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:43:14.582195 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:43:14.582888 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:43:14.583271 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:43:14.583641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:43:14.583990 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:43:14.585900 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:43:14.586666 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:43:14.587322 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:43:14.587760 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:43:14.588126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:43:14.588485 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:43:14.589906 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:43:14.590700 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:43:14.591337 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:43:14.591711 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:43:14.592094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_reviews, now test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38)
[0m13:43:14.592459 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:43:14.603150 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m13:43:14.603918 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:43:14.604573 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m13:43:14.604931 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:43:14.605267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38, now test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7)
[0m13:43:14.605596 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:43:14.610847 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m13:43:14.611617 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:43:14.612269 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m13:43:14.612620 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:43:14.612968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7, now test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0)
[0m13:43:14.613302 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:43:14.616705 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m13:43:14.617409 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:43:14.618078 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m13:43:14.618433 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:43:14.618773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0, now test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182)
[0m13:43:14.619123 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:43:14.626507 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m13:43:14.627510 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:43:14.628273 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m13:43:14.628633 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:43:14.628976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182, now test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7)
[0m13:43:14.629341 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:43:14.634970 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m13:43:14.635978 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:43:14.636804 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m13:43:14.638058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:14.638539 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:43:14.638991 [debug] [MainThread]: Connection 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7' was properly closed.
[0m13:43:14.641648 [debug] [MainThread]: Command end result
[0m13:43:14.780446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:43:14.783663 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:43:14.793878 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:43:14.796575 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m13:43:14.796944 [info ] [MainThread]: Building catalog
[0m13:43:14.806010 [debug] [ThreadPool]: Acquiring new duckdb connection 'google_play.information_schema'
[0m13:43:14.811910 [debug] [ThreadPool]: Using duckdb connection "google_play.information_schema"
[0m13:43:14.812278 [debug] [ThreadPool]: On google_play.information_schema: BEGIN
[0m13:43:14.812559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:14.813367 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:14.813685 [debug] [ThreadPool]: Using duckdb connection "google_play.information_schema"
[0m13:43:14.814016 [debug] [ThreadPool]: On google_play.information_schema: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "google_play.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'google_play'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'google_play'
    )
    select
        'google_play' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m13:43:14.819951 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m13:43:14.822588 [debug] [ThreadPool]: On google_play.information_schema: ROLLBACK
[0m13:43:14.823408 [debug] [ThreadPool]: Failed to rollback 'google_play.information_schema'
[0m13:43:14.823726 [debug] [ThreadPool]: On google_play.information_schema: Close
[0m13:43:14.834134 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\catalog.json
[0m13:43:14.857249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:43:14.859286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:43:14.859592 [info ] [MainThread]: Catalog written to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\catalog.json
[0m13:43:14.860605 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:43:14.860485 after 1.36 seconds
[0m13:43:14.860914 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:43:14.861180 [debug] [MainThread]: Connection 'google_play.information_schema' was properly closed.
[0m13:43:14.861494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE74A2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE959D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEE959CE10>]}
[0m13:43:14.861842 [debug] [MainThread]: Flushing usage events
[0m13:43:15.700661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:12.115806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59AF14C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59C25BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59C25BB10>]}


============================== 13:48:12.121700 | b69363aa-5248-4eb4-bb81-59af612c71f9 ==============================
[0m13:48:12.121700 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:48:12.122997 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:48:12.408103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59B57D940>]}
[0m13:48:12.484934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59C3518C0>]}
[0m13:48:12.487494 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:48:12.743727 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:48:12.899780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:12.900396 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:48:13.311846 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:48:13.312615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DB33650>]}
[0m13:48:13.370559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:48:13.375124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DD1D6D0>]}
[0m13:48:13.447941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:48:13.450264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:48:13.470238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DE3A890>]}
[0m13:48:13.470681 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:48:13.471213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DE006D0>]}
[0m13:48:13.473102 [info ] [MainThread]: 
[0m13:48:13.473613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:13.474069 [info ] [MainThread]: 
[0m13:48:13.474670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:13.479451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:48:13.554083 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:48:13.554473 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:48:13.554788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:13.570686 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:48:13.572044 [debug] [ThreadPool]: On list_google_play: Close
[0m13:48:13.572767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:48:13.573213 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:48:13.579125 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:13.579504 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:48:13.579882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:13.580996 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:13.582708 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:13.583191 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:48:13.583765 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:13.584061 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:13.584355 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:48:13.585005 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:13.586063 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:48:13.586378 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:13.586671 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:48:13.587139 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:13.587446 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:48:13.589041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:48:13.594436 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:48:13.594929 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:48:13.595230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:13.595850 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:13.596146 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:48:13.596446 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:48:13.612056 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:48:13.613451 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:48:13.614604 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:48:13.614926 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:48:13.616184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DF8D550>]}
[0m13:48:13.616619 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:13.616912 [debug] [MainThread]: On master: BEGIN
[0m13:48:13.617186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:13.617783 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:13.618100 [debug] [MainThread]: On master: COMMIT
[0m13:48:13.618388 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:13.618667 [debug] [MainThread]: On master: COMMIT
[0m13:48:13.619181 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:13.619485 [debug] [MainThread]: On master: Close
[0m13:48:13.623773 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:48:13.624323 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:48:13.625082 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:48:13.625446 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:48:13.631627 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:48:13.632537 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:48:13.662263 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:48:13.663316 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.663900 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:48:13.664359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:13.665217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:13.665572 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.665923 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:48:13.666710 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:13.672471 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.672916 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:48:13.673692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:13.676735 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.677152 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:48:13.677865 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:13.689313 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:48:13.689747 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.690082 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:48:13.693326 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:48:13.698480 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:13.698888 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:48:13.701200 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:13.703558 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:48:13.705448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59DF726D0>]}
[0m13:48:13.706101 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:48:13.706901 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:48:13.707296 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:48:13.707743 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:48:13.708335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:48:13.708694 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:48:13.710891 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.711740 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:48:13.714686 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.715665 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.716262 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:48:13.716616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:13.717374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:13.717847 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.718244 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    try_cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- Keeps the unique app by prioritizing the highest rating (and puts NULLs at the bottom)
qualify row_number() over (partition by app_id order by try_cast(score as float) desc nulls last) = 1
  );

[0m13:48:13.723117 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:48:13.726831 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.727348 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:48:13.728223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:13.731440 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.731935 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:48:13.732783 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:13.734606 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:48:13.735049 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.735444 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:48:13.737828 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:13.741003 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:13.741498 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:48:13.743766 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:13.745138 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:48:13.745728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59E33FF70>]}
[0m13:48:13.746433 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.04s]
[0m13:48:13.747585 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:48:13.748034 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:13.748591 [info ] [Thread-1 (]: 3 of 3 START sql incremental model main.stg_playstore_reviews .................. [RUN]
[0m13:48:13.749281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:48:13.749681 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:13.752970 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:13.753925 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:13.799313 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:13.800275 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:13.800670 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:48:13.801006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:13.801725 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:13.802098 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:13.802473 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
    
    

    create  table
      "google_play"."main"."stg_playstore_reviews__dbt_tmp"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


    );
  
  
  
[0m13:48:13.807356 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at

LINE 18:     cast("at" as timestamp) as review_date
             ^
[0m13:48:13.807829 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
    
    

    create  table
      "google_play"."main"."stg_playstore_reviews__dbt_tmp"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


    );
  
  
  
[0m13:48:13.808192 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:48:13.808575 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: ROLLBACK
[0m13:48:13.810607 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_reviews'
[0m13:48:13.811094 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:48:13.817666 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^
[0m13:48:13.818229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69363aa-5248-4eb4-bb81-59af612c71f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59E218B50>]}
[0m13:48:13.818859 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model main.stg_playstore_reviews ......... [[31mERROR[0m in 0.07s]
[0m13:48:13.819700 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:13.820268 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_reviews' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^.
[0m13:48:13.822053 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:13.822394 [debug] [MainThread]: On master: BEGIN
[0m13:48:13.822677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:13.823314 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:13.823624 [debug] [MainThread]: On master: COMMIT
[0m13:48:13.823911 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:13.824185 [debug] [MainThread]: On master: COMMIT
[0m13:48:13.824644 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:13.824941 [debug] [MainThread]: On master: Close
[0m13:48:13.825314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:13.825591 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:48:13.825847 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:48:13.826099 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:48:13.826444 [info ] [MainThread]: 
[0m13:48:13.826943 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:48:13.828098 [debug] [MainThread]: Command end result
[0m13:48:13.853291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:48:13.856078 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:48:13.863896 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:48:13.864533 [info ] [MainThread]: 
[0m13:48:13.865125 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:48:13.865663 [info ] [MainThread]: 
[0m13:48:13.866224 [error] [MainThread]: [31mFailure in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)[0m
[0m13:48:13.866769 [error] [MainThread]:   Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^
[0m13:48:13.867274 [info ] [MainThread]: 
[0m13:48:13.867811 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_reviews.sql
[0m13:48:13.868806 [info ] [MainThread]: 
[0m13:48:13.869384 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:48:13.870023 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:48:13.871005 [debug] [MainThread]: Command `dbt run` failed at 13:48:13.870877 after 1.93 seconds
[0m13:48:13.871402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B59C291780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B595A442F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B598F04EF0>]}
[0m13:48:13.871818 [debug] [MainThread]: Flushing usage events
[0m13:48:14.816257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:29.535835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236A9FF4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AB32BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AB32BB10>]}


============================== 13:48:29.539904 | be635f4a-073c-4e97-9870-34a4eb388207 ==============================
[0m13:48:29.539904 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:48:29.540562 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:48:29.775233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AA64DA70>]}
[0m13:48:29.841685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AB4218C0>]}
[0m13:48:29.844404 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:48:30.104022 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:48:30.255684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:48:30.256046 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:48:30.256317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:48:30.262288 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:48:30.296417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ACB3E450>]}
[0m13:48:30.373294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:48:30.375650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:48:30.395161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AC7FCC80>]}
[0m13:48:30.395627 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:48:30.396141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AB383D90>]}
[0m13:48:30.397985 [info ] [MainThread]: 
[0m13:48:30.398524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:30.398984 [info ] [MainThread]: 
[0m13:48:30.399690 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:30.404332 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:48:30.478370 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:48:30.478823 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:48:30.479163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:30.506164 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:48:30.507454 [debug] [ThreadPool]: On list_google_play: Close
[0m13:48:30.508120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:48:30.508558 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:48:30.514739 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:30.515125 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:48:30.515419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:30.516404 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:30.517600 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:30.517902 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:48:30.518426 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:30.518715 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:30.518998 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:48:30.519526 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:30.520304 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:48:30.520610 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:48:30.520893 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:48:30.521355 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:30.521660 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:48:30.523271 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:48:30.530699 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:48:30.531063 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:48:30.531352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:30.531969 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:30.532266 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:48:30.532562 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:48:30.547243 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:48:30.548573 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:48:30.549567 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:48:30.549866 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:48:30.551114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ACF92000>]}
[0m13:48:30.551542 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:30.551831 [debug] [MainThread]: On master: BEGIN
[0m13:48:30.552103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:30.552649 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:30.552941 [debug] [MainThread]: On master: COMMIT
[0m13:48:30.553222 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:30.553504 [debug] [MainThread]: On master: COMMIT
[0m13:48:30.553959 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:30.554253 [debug] [MainThread]: On master: Close
[0m13:48:30.558643 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:48:30.559266 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:48:30.560060 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:48:30.560425 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:48:30.566261 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:48:30.567062 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:48:30.645167 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:48:30.646064 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.646427 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:48:30.646762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:30.647536 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:30.647893 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.648239 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:48:30.649023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:30.654509 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.654891 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:48:30.655566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:30.658359 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.658724 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:48:30.659351 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:30.670285 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:48:30.670664 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.671011 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:48:30.674034 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:48:30.679596 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:48:30.680000 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:48:30.682222 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:30.684700 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:48:30.686337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ACDA2690>]}
[0m13:48:30.686911 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.13s]
[0m13:48:30.687707 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:48:30.688136 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:48:30.688588 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:48:30.689187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:48:30.689545 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:48:30.691117 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.691899 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:48:30.695051 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.695819 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.696175 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:48:30.696542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:30.697208 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:30.697556 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.697954 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    try_cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- Keeps the unique app by prioritizing the highest rating (and puts NULLs at the bottom)
qualify row_number() over (partition by app_id order by try_cast(score as float) desc nulls last) = 1
  );

[0m13:48:30.702822 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:48:30.705810 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.706245 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:48:30.707008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:30.709865 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.710276 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:48:30.711050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:48:30.712925 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:48:30.713787 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.714191 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:48:30.716514 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:30.720007 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:48:30.720520 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:48:30.722965 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:48:30.724437 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:48:30.724973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ACF94E10>]}
[0m13:48:30.725531 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.04s]
[0m13:48:30.726682 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:48:30.727057 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:30.727488 [info ] [Thread-1 (]: 3 of 3 START sql incremental model main.stg_playstore_reviews .................. [RUN]
[0m13:48:30.728134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:48:30.728492 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:30.734796 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:30.735739 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:30.786842 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:30.787936 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:30.788414 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:48:30.788832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:30.789611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:30.790021 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:48:30.790438 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
    
    

    create  table
      "google_play"."main"."stg_playstore_reviews__dbt_tmp"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


    );
  
  
  
[0m13:48:30.795790 [debug] [Thread-1 (]: DuckDB adapter: duckdb error: Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at

LINE 18:     cast("at" as timestamp) as review_date
             ^
[0m13:48:30.796333 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
    
    

    create  table
      "google_play"."main"."stg_playstore_reviews__dbt_tmp"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


    );
  
  
  
[0m13:48:30.796789 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:48:30.797192 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: ROLLBACK
[0m13:48:30.799220 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_reviews'
[0m13:48:30.799746 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:48:30.806609 [debug] [Thread-1 (]: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^
[0m13:48:30.807125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be635f4a-073c-4e97-9870-34a4eb388207', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AD158550>]}
[0m13:48:30.807788 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model main.stg_playstore_reviews ......... [[31mERROR[0m in 0.08s]
[0m13:48:30.808615 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:48:30.809319 [debug] [Thread-4 (]: Marking all children of 'model.lab2_pipeline.stg_playstore_reviews' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^.
[0m13:48:30.811089 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:30.811408 [debug] [MainThread]: On master: BEGIN
[0m13:48:30.811712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:30.812388 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:30.812706 [debug] [MainThread]: On master: COMMIT
[0m13:48:30.812989 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:30.813273 [debug] [MainThread]: On master: COMMIT
[0m13:48:30.813735 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:30.814036 [debug] [MainThread]: On master: Close
[0m13:48:30.814401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:30.814669 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:48:30.814922 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:48:30.815173 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:48:30.815505 [info ] [MainThread]: 
[0m13:48:30.815988 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:48:30.817154 [debug] [MainThread]: Command end result
[0m13:48:30.842052 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:48:30.844374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:48:30.850404 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:48:30.850790 [info ] [MainThread]: 
[0m13:48:30.851341 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:48:30.851820 [info ] [MainThread]: 
[0m13:48:30.852293 [error] [MainThread]: [31mFailure in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)[0m
[0m13:48:30.852846 [error] [MainThread]:   Runtime Error in model stg_playstore_reviews (models\staging\stg_playstore_reviews.sql)
  Conversion Error: invalid timestamp field format: "not_a_date", expected format is (YYYY-MM-DD HH:MM:SS[.US][±HH[:MM[:SS]]| ZONE]) when casting from source column at
  
  LINE 18:     cast("at" as timestamp) as review_date
               ^
[0m13:48:30.853321 [info ] [MainThread]: 
[0m13:48:30.853795 [info ] [MainThread]:   compiled code at target\compiled\lab2_pipeline\models\staging\stg_playstore_reviews.sql
[0m13:48:30.854243 [info ] [MainThread]: 
[0m13:48:30.854698 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:48:30.855601 [debug] [MainThread]: Command `dbt run` failed at 13:48:30.855487 after 1.46 seconds
[0m13:48:30.855963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AC8F02D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AC8098D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236AB361780>]}
[0m13:48:30.856313 [debug] [MainThread]: Flushing usage events
[0m13:48:31.649552 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:41.756793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F208F04C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20A23BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20A23BB10>]}


============================== 13:49:41.760839 | 677ba9f3-c425-429b-9d58-10616d3ca3df ==============================
[0m13:49:41.760839 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:49:41.761483 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:49:42.055559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20955DA70>]}
[0m13:49:42.136162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20A3358C0>]}
[0m13:49:42.138528 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:49:42.405969 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:49:42.550000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:42.550606 [debug] [MainThread]: Partial parsing: updated file: lab2_pipeline://models\staging\stg_playstore_reviews.sql
[0m13:49:42.953317 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on
'stg_playstore_reviews' in package 'lab2_pipeline' (models\staging\schema.yml).
Arguments to generic tests should be nested under the `arguments` property.
[0m13:49:42.953990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BA9F550>]}
[0m13:49:43.012053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:49:43.016778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BB119A0>]}
[0m13:49:43.094312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:49:43.096506 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:49:43.114667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BDAA890>]}
[0m13:49:43.115110 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:49:43.115609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BE086D0>]}
[0m13:49:43.117384 [info ] [MainThread]: 
[0m13:49:43.117897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:43.118341 [info ] [MainThread]: 
[0m13:49:43.118949 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:49:43.123538 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:49:43.195754 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:49:43.196138 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:49:43.196438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:43.223247 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m13:49:43.224552 [debug] [ThreadPool]: On list_google_play: Close
[0m13:49:43.225186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:49:43.225665 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:49:43.231531 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:49:43.231882 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:49:43.232167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:43.233123 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:43.234712 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:49:43.235029 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:49:43.235552 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:43.235836 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:49:43.236116 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:49:43.236637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:43.237411 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:49:43.237710 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:49:43.238000 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:49:43.238556 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:49:43.238945 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:49:43.240616 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:49:43.245906 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:49:43.246295 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:49:43.246619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:43.247331 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:49:43.247686 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:49:43.248024 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:49:43.264182 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:49:43.265512 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:49:43.266501 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:49:43.266805 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:49:43.268138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BEF1610>]}
[0m13:49:43.268557 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:43.268842 [debug] [MainThread]: On master: BEGIN
[0m13:49:43.269107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:43.269686 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:43.269985 [debug] [MainThread]: On master: COMMIT
[0m13:49:43.270264 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:43.270533 [debug] [MainThread]: On master: COMMIT
[0m13:49:43.270974 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:43.271261 [debug] [MainThread]: On master: Close
[0m13:49:43.275227 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:49:43.275720 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:49:43.276615 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:49:43.276968 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:49:43.282822 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:49:43.283632 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:49:43.312282 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:49:43.313272 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.313645 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:49:43.313972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:49:43.314755 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.315104 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.315445 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:49:43.316189 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.321663 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.322032 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:49:43.322696 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.325513 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.325870 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:49:43.326502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.337983 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:49:43.338415 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.338780 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:49:43.341870 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:49:43.347045 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:49:43.347491 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:49:43.349476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:43.351684 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:49:43.353281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20BEDA620>]}
[0m13:49:43.353865 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.08s]
[0m13:49:43.354678 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:49:43.355070 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:49:43.355510 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:49:43.356166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:49:43.356547 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:49:43.358580 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.359455 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:49:43.362239 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.363119 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.363502 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:49:43.363862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:43.364523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.364886 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.365266 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    try_cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- Keeps the unique app by prioritizing the highest rating (and puts NULLs at the bottom)
qualify row_number() over (partition by app_id order by try_cast(score as float) desc nulls last) = 1
  );

[0m13:49:43.369861 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:49:43.373289 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.373735 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:49:43.374502 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.377155 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.377545 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:49:43.378307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.379685 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:49:43.380056 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.380387 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:49:43.382835 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:43.385632 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:49:43.386079 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:49:43.388140 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:43.389514 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:49:43.390048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20C2AFED0>]}
[0m13:49:43.390613 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.03s]
[0m13:49:43.391440 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:49:43.391832 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:49:43.392409 [info ] [Thread-1 (]: 3 of 3 START sql incremental model main.stg_playstore_reviews .................. [RUN]
[0m13:49:43.393402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:49:43.393822 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:49:43.396846 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.397684 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:49:43.441343 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.442299 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.442670 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:49:43.443007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:43.443703 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.444067 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.444436 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

  
    
    

    create  table
      "google_play"."main"."stg_playstore_reviews__dbt_tmp"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    try_cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


    );
  
  
  
[0m13:49:43.449356 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:49:43.455040 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.455589 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_playstore_reviews'
  
[0m13:49:43.456632 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.457978 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.458404 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_playstore_reviews'
  
[0m13:49:43.459527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.462905 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.463342 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter view "google_play"."main"."stg_playstore_reviews" rename to "stg_playstore_reviews__dbt_backup"
[0m13:49:43.464069 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.466949 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.467401 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
alter table "google_play"."main"."stg_playstore_reviews__dbt_tmp" rename to "stg_playstore_reviews"
[0m13:49:43.468193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.473489 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:49:43.473928 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.474328 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:49:43.476764 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:49:43.477444 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.477833 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:49:43.478509 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.478903 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.479369 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_playstore_reviews__dbt_backup'
  
[0m13:49:43.480300 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.481653 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.482132 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'stg_playstore_reviews__dbt_backup'
  
[0m13:49:43.483101 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:49:43.486693 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:49:43.487137 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:49:43.487932 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:49:43.489263 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: ROLLBACK
[0m13:49:43.490049 [debug] [Thread-1 (]: Failed to rollback 'model.lab2_pipeline.stg_playstore_reviews'
[0m13:49:43.490442 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:49:43.491005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677ba9f3-c425-429b-9d58-10616d3ca3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20C1564D0>]}
[0m13:49:43.491642 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model main.stg_playstore_reviews ............. [[32mOK[0m in 0.10s]
[0m13:49:43.492579 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:49:43.493859 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:43.494197 [debug] [MainThread]: On master: BEGIN
[0m13:49:43.494505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:43.495077 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:49:43.495379 [debug] [MainThread]: On master: COMMIT
[0m13:49:43.495694 [debug] [MainThread]: Using duckdb connection "master"
[0m13:49:43.495971 [debug] [MainThread]: On master: COMMIT
[0m13:49:43.496463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:49:43.496751 [debug] [MainThread]: On master: Close
[0m13:49:43.497098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:43.497359 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:49:43.497715 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:49:43.498051 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:49:43.498379 [info ] [MainThread]: 
[0m13:49:43.498881 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:49:43.500013 [debug] [MainThread]: Command end result
[0m13:49:43.530969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:49:43.533113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:49:43.539296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:49:43.539785 [info ] [MainThread]: 
[0m13:49:43.540323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:43.540773 [info ] [MainThread]: 
[0m13:49:43.541240 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:49:43.541860 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:49:43.542843 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:43.542732 after 1.96 seconds
[0m13:49:43.543183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20A271780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F203AB42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F20950E6F0>]}
[0m13:49:43.543529 [debug] [MainThread]: Flushing usage events
[0m13:49:44.407443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:35.386052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020577A24C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578D57ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578D57B10>]}


============================== 13:50:35.389835 | 22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4 ==============================
[0m13:50:35.389835 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:50:35.390464 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:50:35.617176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057807DA70>]}
[0m13:50:35.679279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578E598C0>]}
[0m13:50:35.681329 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:50:35.902685 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:50:36.041536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:36.041915 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m13:50:36.042192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:36.048362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:50:36.083107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A67E450>]}
[0m13:50:36.160893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:50:36.163122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:50:36.181505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A33CC80>]}
[0m13:50:36.181962 [info ] [MainThread]: Found 3 models, 5 data tests, 588 macros
[0m13:50:36.182476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578DB3D90>]}
[0m13:50:36.184373 [info ] [MainThread]: 
[0m13:50:36.184925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:36.185383 [info ] [MainThread]: 
[0m13:50:36.186000 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:50:36.190511 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:50:36.262821 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:50:36.263188 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:50:36.263478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:36.285774 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:50:36.286998 [debug] [ThreadPool]: On list_google_play: Close
[0m13:50:36.287643 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:50:36.288075 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:50:36.293723 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:50:36.294031 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:50:36.294312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:36.295168 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:36.296406 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:50:36.296698 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:50:36.297163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:36.297452 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:50:36.297727 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:50:36.298234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:36.298979 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:50:36.299280 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:50:36.299556 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:50:36.300061 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:50:36.300356 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:50:36.301814 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:50:36.309063 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:50:36.309407 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:50:36.309690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:36.310273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:50:36.310564 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:50:36.310853 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:50:36.326377 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:50:36.327772 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:50:36.328737 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:50:36.329028 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:50:36.330377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057AACE000>]}
[0m13:50:36.330777 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:36.331053 [debug] [MainThread]: On master: BEGIN
[0m13:50:36.331319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:36.331843 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:50:36.332125 [debug] [MainThread]: On master: COMMIT
[0m13:50:36.332405 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:36.332667 [debug] [MainThread]: On master: COMMIT
[0m13:50:36.333099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:50:36.333388 [debug] [MainThread]: On master: Close
[0m13:50:36.337130 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m13:50:36.337637 [info ] [Thread-1 (]: 1 of 3 START sql view model main.connection_test ............................... [RUN]
[0m13:50:36.338320 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m13:50:36.338668 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m13:50:36.344663 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m13:50:36.345464 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m13:50:36.416507 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.connection_test"
[0m13:50:36.417430 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.417784 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: BEGIN
[0m13:50:36.418105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:36.418855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:36.419189 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.419531 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

  
  create view "google_play"."main"."connection_test__dbt_tmp" as (
    -- Connection test to prove dbt can create objects in DuckDB [cite: 140]
select 
    1 as ok, 
    current_timestamp as created_at
  );

[0m13:50:36.420254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.425638 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.426011 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test" rename to "connection_test__dbt_backup"
[0m13:50:36.426664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.429422 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.429772 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */
alter view "google_play"."main"."connection_test__dbt_tmp" rename to "connection_test"
[0m13:50:36.430458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.441176 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:50:36.441572 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.441911 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: COMMIT
[0m13:50:36.444677 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.449845 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.connection_test"
[0m13:50:36.450238 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.connection_test"} */

      drop view if exists "google_play"."main"."connection_test__dbt_backup" cascade
    
[0m13:50:36.452391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.454748 [debug] [Thread-1 (]: On model.lab2_pipeline.connection_test: Close
[0m13:50:36.456480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A8E2750>]}
[0m13:50:36.457136 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.connection_test .......................... [[32mOK[0m in 0.12s]
[0m13:50:36.457874 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m13:50:36.458254 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m13:50:36.458911 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_playstore_apps ............................ [RUN]
[0m13:50:36.459460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m13:50:36.459816 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m13:50:36.461787 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.462920 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m13:50:36.466606 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.467657 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.468125 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: BEGIN
[0m13:50:36.468461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:36.469081 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:50:36.469427 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.469781 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

  
  create view "google_play"."main"."stg_playstore_apps__dbt_tmp" as (
    select
    cast(appid as varchar) as app_id,
    cast(title as varchar) as app_name,
    try_cast(score as float) as rating,
    cast(genre as varchar) as category,
    cast(developer as varchar) as developer_name
from read_csv(
    'raw_data/note_taking_ai_apps_updated.csv',
    header=true,
    delim=',',
    normalize_names=true,
    ignore_errors=true,
    null_padding=true,
    strict_mode=false
)
-- Keeps the unique app by prioritizing the highest rating (and puts NULLs at the bottom)
qualify row_number() over (partition by app_id order by try_cast(score as float) desc nulls last) = 1
  );

[0m13:50:36.474559 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:50:36.477409 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.477804 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps" rename to "stg_playstore_apps__dbt_backup"
[0m13:50:36.478589 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.481343 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.481756 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */
alter view "google_play"."main"."stg_playstore_apps__dbt_tmp" rename to "stg_playstore_apps"
[0m13:50:36.482549 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.484442 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:50:36.484895 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.485267 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: COMMIT
[0m13:50:36.487948 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.490676 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_apps"
[0m13:50:36.491048 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_apps"} */

      drop view if exists "google_play"."main"."stg_playstore_apps__dbt_backup" cascade
    
[0m13:50:36.493618 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.495114 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_apps: Close
[0m13:50:36.495616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057AAD4470>]}
[0m13:50:36.496175 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_playstore_apps ....................... [[32mOK[0m in 0.04s]
[0m13:50:36.497093 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m13:50:36.497554 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m13:50:36.497989 [info ] [Thread-1 (]: 3 of 3 START sql incremental model main.stg_playstore_reviews .................. [RUN]
[0m13:50:36.498568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m13:50:36.498913 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m13:50:36.506380 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.507221 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m13:50:36.546199 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.546606 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      drop view if exists "google_play"."main"."stg_playstore_reviews__dbt_backup" cascade
    
[0m13:50:36.546957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:36.549270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.557518 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.557954 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

    
  
    
    

    create temporary table
      "stg_playstore_reviews__dbt_tmp20260222135036541030"
  
    as (
      

select
    cast("reviewId" as varchar) as review_id,
    cast(app_id as varchar) as app_id,
    cast(content as varchar) as review_text,
    try_cast(score as integer) as review_score,
    try_cast("at" as timestamp) as review_date
from read_csv_auto('raw_data/note_taking_ai_reviews_dirty.csv')


  -- This tells dbt to only load reviews that are newer than the newest review already in the table
  where try_cast("at" as timestamp) > (select max(review_date) from "google_play"."main"."stg_playstore_reviews")

    );
  
  
  
[0m13:50:36.563502 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:50:36.570251 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.570660 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: BEGIN
[0m13:50:36.571307 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.571683 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.572058 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_playstore_reviews__dbt_tmp20260222135036541030'
      
      
      order by ordinal_position

  
[0m13:50:36.574940 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.580070 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.580507 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_playstore_reviews'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m13:50:36.583551 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:50:36.592484 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.592972 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_playstore_reviews'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m13:50:36.596005 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:50:36.597692 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.598112 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */
SELECT version()
[0m13:50:36.598858 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.614787 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.615834 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.616283 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "model.lab2_pipeline.stg_playstore_reviews"} */

        
            delete from "google_play"."main"."stg_playstore_reviews"
            where (
                review_id) in (
                select (review_id)
                from "stg_playstore_reviews__dbt_tmp20260222135036541030"
            );

        
    

    insert into "google_play"."main"."stg_playstore_reviews" ("review_id", "app_id", "review_text", "review_score", "review_date")
    (
        select "review_id", "app_id", "review_text", "review_score", "review_date"
        from "stg_playstore_reviews__dbt_tmp20260222135036541030"
    )
  
[0m13:50:36.618538 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:50:36.620026 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:50:36.620400 [debug] [Thread-1 (]: Using duckdb connection "model.lab2_pipeline.stg_playstore_reviews"
[0m13:50:36.620738 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: COMMIT
[0m13:50:36.621375 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:50:36.622151 [debug] [Thread-1 (]: On model.lab2_pipeline.stg_playstore_reviews: Close
[0m13:50:36.622686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b74875-afbd-4ac6-bbc9-d3c2bc08c9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A8D6350>]}
[0m13:50:36.623272 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model main.stg_playstore_reviews ............. [[32mOK[0m in 0.12s]
[0m13:50:36.624074 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m13:50:36.625397 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:36.625735 [debug] [MainThread]: On master: BEGIN
[0m13:50:36.626033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:36.626637 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:50:36.626965 [debug] [MainThread]: On master: COMMIT
[0m13:50:36.627269 [debug] [MainThread]: Using duckdb connection "master"
[0m13:50:36.627562 [debug] [MainThread]: On master: COMMIT
[0m13:50:36.628090 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:50:36.628424 [debug] [MainThread]: On master: Close
[0m13:50:36.628837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:36.629118 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:50:36.629382 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:50:36.629654 [debug] [MainThread]: Connection 'model.lab2_pipeline.stg_playstore_reviews' was properly closed.
[0m13:50:36.630029 [info ] [MainThread]: 
[0m13:50:36.630526 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:50:36.631858 [debug] [MainThread]: Command end result
[0m13:50:36.660033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:50:36.663132 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:50:36.670065 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:50:36.670432 [info ] [MainThread]: 
[0m13:50:36.671101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:36.671773 [info ] [MainThread]: 
[0m13:50:36.672615 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m13:50:36.673851 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:36.673722 after 1.43 seconds
[0m13:50:36.674209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A789450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A4311D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020578D91780>]}
[0m13:50:36.674561 [debug] [MainThread]: Flushing usage events
[0m13:50:37.472503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:41.731367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281790C4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817A40FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817A40FB10>]}


============================== 13:59:41.735368 | 9c0316b0-03ed-43c5-8123-209a0ed1a201 ==============================
[0m13:59:41.735368 [info ] [MainThread]: Running with dbt=1.11.6
[0m13:59:41.736187 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt snapshot --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m13:59:41.982017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817972DA70>]}
[0m13:59:42.053122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817B4E58C0>]}
[0m13:59:42.055494 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m13:59:42.297370 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m13:59:42.440594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:59:42.441068 [debug] [MainThread]: Partial parsing: added file: lab2_pipeline://snapshots\apps_snapshot.sql
[0m13:59:42.731534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m13:59:42.736071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817BC8E550>]}
[0m13:59:42.865808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:59:42.867985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:59:42.887672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817B56FD40>]}
[0m13:59:42.888122 [info ] [MainThread]: Found 3 models, 5 data tests, 1 snapshot, 588 macros
[0m13:59:42.888679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817BADACF0>]}
[0m13:59:42.890459 [info ] [MainThread]: 
[0m13:59:42.890959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:42.891365 [info ] [MainThread]: 
[0m13:59:42.891975 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:59:42.892961 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m13:59:42.962032 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m13:59:42.962396 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m13:59:42.962691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:42.986023 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:59:42.987292 [debug] [ThreadPool]: On list_google_play: Close
[0m13:59:42.987953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m13:59:42.988389 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m13:59:42.994075 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:59:42.994401 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m13:59:42.994689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:42.995691 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:59:42.996833 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:59:42.997127 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m13:59:42.997655 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:42.997940 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:59:42.998219 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m13:59:42.998775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:42.999535 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:59:42.999845 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m13:59:43.000125 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m13:59:43.000570 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:59:43.000869 [debug] [ThreadPool]: On create_google_play_main: Close
[0m13:59:43.005893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m13:59:43.010988 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:59:43.011556 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m13:59:43.011970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:43.012729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:59:43.013023 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m13:59:43.013340 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m13:59:43.027903 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:59:43.029256 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m13:59:43.030354 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m13:59:43.030651 [debug] [ThreadPool]: On list_google_play_main: Close
[0m13:59:43.031890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817C1E0FC0>]}
[0m13:59:43.032298 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:43.032576 [debug] [MainThread]: On master: BEGIN
[0m13:59:43.032851 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:43.033535 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:59:43.033830 [debug] [MainThread]: On master: COMMIT
[0m13:59:43.034107 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:43.034374 [debug] [MainThread]: On master: COMMIT
[0m13:59:43.034870 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:59:43.035160 [debug] [MainThread]: On master: Close
[0m13:59:43.039306 [debug] [Thread-1 (]: Began running node snapshot.lab2_pipeline.apps_snapshot
[0m13:59:43.039802 [info ] [Thread-1 (]: 1 of 1 START snapshot main.apps_snapshot ....................................... [RUN]
[0m13:59:43.040467 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.lab2_pipeline.apps_snapshot'
[0m13:59:43.040806 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_pipeline.apps_snapshot
[0m13:59:43.048194 [debug] [Thread-1 (]: Began executing node snapshot.lab2_pipeline.apps_snapshot
[0m13:59:43.126314 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.126842 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */
DESCRIBE (select * from (
        
    

    select *,
        md5(coalesce(cast(app_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp as dbt_updated_at,
        now()::timestamp as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp, now()::timestamp), null)
  as dbt_valid_to
from (
        

select * from "google_play"."main"."stg_playstore_apps"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:59:43.127266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:43.132868 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:59:43.136458 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.136904 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m13:59:43.137860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:59:43.138476 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.139809 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.140206 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: BEGIN
[0m13:59:43.140836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:59:43.141220 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.141600 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      
  
    
    

    create  table
      "google_play"."main"."apps_snapshot"
  
    as (
      
    

    select *,
        md5(coalesce(cast(app_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp as dbt_updated_at,
        now()::timestamp as dbt_valid_from,
        
  
  coalesce(nullif(now()::timestamp, now()::timestamp), null)
  as dbt_valid_to
from (
        

select * from "google_play"."main"."stg_playstore_apps"
    ) sbq



    );
  
  
  
[0m13:59:43.150908 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:59:43.164871 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: COMMIT
[0m13:59:43.165355 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m13:59:43.165749 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: COMMIT
[0m13:59:43.169121 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:59:43.170964 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: Close
[0m13:59:43.172790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c0316b0-03ed-43c5-8123-209a0ed1a201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817BFFB590>]}
[0m13:59:43.173589 [info ] [Thread-1 (]: 1 of 1 OK snapshotted main.apps_snapshot ....................................... [[32mOK[0m in 0.13s]
[0m13:59:43.174481 [debug] [Thread-1 (]: Finished running node snapshot.lab2_pipeline.apps_snapshot
[0m13:59:43.175711 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:43.176045 [debug] [MainThread]: On master: BEGIN
[0m13:59:43.176335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:43.176925 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:59:43.177245 [debug] [MainThread]: On master: COMMIT
[0m13:59:43.177525 [debug] [MainThread]: Using duckdb connection "master"
[0m13:59:43.177791 [debug] [MainThread]: On master: COMMIT
[0m13:59:43.178231 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:59:43.178520 [debug] [MainThread]: On master: Close
[0m13:59:43.178873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:43.179132 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m13:59:43.179395 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m13:59:43.179640 [debug] [MainThread]: Connection 'snapshot.lab2_pipeline.apps_snapshot' was properly closed.
[0m13:59:43.179915 [info ] [MainThread]: 
[0m13:59:43.180388 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:59:43.181503 [debug] [MainThread]: Command end result
[0m13:59:43.209330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m13:59:43.211594 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m13:59:43.217387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m13:59:43.217729 [info ] [MainThread]: 
[0m13:59:43.218287 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:43.218795 [info ] [MainThread]: 
[0m13:59:43.219273 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:59:43.220260 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:59:43.220118 after 1.69 seconds
[0m13:59:43.220641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817C006BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817BF43570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817BF43890>]}
[0m13:59:43.221108 [debug] [MainThread]: Flushing usage events
[0m13:59:44.124330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:38.294100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAACE4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAC007ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAC007C50>]}


============================== 14:00:38.297976 | 55c8a8ba-1bf9-443a-b5d4-35b27f655fea ==============================
[0m14:00:38.297976 [info ] [MainThread]: Running with dbt=1.11.6
[0m14:00:38.298636 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m14:00:38.550023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAB335A70>]}
[0m14:00:38.612198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAC1198C0>]}
[0m14:00:38.614236 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m14:00:38.838960 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m14:00:39.002048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:00:39.002391 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:00:39.002640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:00:39.008454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m14:00:39.053755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAD8B6350>]}
[0m14:00:39.072349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAD968140>]}
[0m14:00:39.072812 [info ] [MainThread]: Found 3 models, 5 data tests, 1 snapshot, 588 macros
[0m14:00:39.073526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAD5A0E50>]}
[0m14:00:39.075501 [info ] [MainThread]: 
[0m14:00:39.075994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:39.076433 [info ] [MainThread]: 
[0m14:00:39.077045 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:00:39.081606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m14:00:39.156280 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m14:00:39.156648 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m14:00:39.156927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:39.178297 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:00:39.178685 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m14:00:39.179004 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m14:00:39.193953 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m14:00:39.195306 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m14:00:39.196283 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m14:00:39.196582 [debug] [ThreadPool]: On list_google_play_main: Close
[0m14:00:39.198026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c8a8ba-1bf9-443a-b5d4-35b27f655fea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BADC73BA0>]}
[0m14:00:39.202050 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.connection_test
[0m14:00:39.202545 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.lab2_pipeline.connection_test'
[0m14:00:39.202887 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.connection_test
[0m14:00:39.208555 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.connection_test"
[0m14:00:39.209320 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.connection_test
[0m14:00:39.210066 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.connection_test
[0m14:00:39.210442 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_apps
[0m14:00:39.210805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.connection_test, now model.lab2_pipeline.stg_playstore_apps)
[0m14:00:39.211152 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_apps
[0m14:00:39.213071 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_apps"
[0m14:00:39.214320 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_apps
[0m14:00:39.215007 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_apps
[0m14:00:39.215388 [debug] [Thread-1 (]: Began running node model.lab2_pipeline.stg_playstore_reviews
[0m14:00:39.215741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_apps, now model.lab2_pipeline.stg_playstore_reviews)
[0m14:00:39.216101 [debug] [Thread-1 (]: Began compiling node model.lab2_pipeline.stg_playstore_reviews
[0m14:00:39.223147 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_pipeline.stg_playstore_reviews"
[0m14:00:39.223988 [debug] [Thread-1 (]: Began executing node model.lab2_pipeline.stg_playstore_reviews
[0m14:00:39.224627 [debug] [Thread-1 (]: Finished running node model.lab2_pipeline.stg_playstore_reviews
[0m14:00:39.224995 [debug] [Thread-1 (]: Began running node snapshot.lab2_pipeline.apps_snapshot
[0m14:00:39.225427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_pipeline.stg_playstore_reviews, now snapshot.lab2_pipeline.apps_snapshot)
[0m14:00:39.225785 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_pipeline.apps_snapshot
[0m14:00:39.228699 [debug] [Thread-1 (]: Began executing node snapshot.lab2_pipeline.apps_snapshot
[0m14:00:39.229503 [debug] [Thread-1 (]: Finished running node snapshot.lab2_pipeline.apps_snapshot
[0m14:00:39.229879 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m14:00:39.230239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.lab2_pipeline.apps_snapshot, now test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38)
[0m14:00:39.230580 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m14:00:39.240507 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38"
[0m14:00:39.241425 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m14:00:39.242076 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38
[0m14:00:39.242448 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m14:00:39.242800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_apps_app_id.1199dc4d38, now test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7)
[0m14:00:39.243154 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m14:00:39.248856 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7"
[0m14:00:39.249688 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m14:00:39.250328 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7
[0m14:00:39.250695 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m14:00:39.251045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.unique_stg_playstore_apps_app_id.5cfd5cf9e7, now test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0)
[0m14:00:39.251392 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m14:00:39.254655 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0"
[0m14:00:39.255354 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m14:00:39.255982 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0
[0m14:00:39.256342 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m14:00:39.256696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.not_null_stg_playstore_reviews_review_id.165b23bad0, now test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182)
[0m14:00:39.257040 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m14:00:39.267189 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182"
[0m14:00:39.268096 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m14:00:39.268803 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182
[0m14:00:39.269174 [debug] [Thread-1 (]: Began running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m14:00:39.269528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_pipeline.relationships_stg_playstore_reviews_app_id__app_id__ref_stg_playstore_apps_.6dc08ce182, now test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7)
[0m14:00:39.269879 [debug] [Thread-1 (]: Began compiling node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m14:00:39.273037 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7"
[0m14:00:39.273761 [debug] [Thread-1 (]: Began executing node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m14:00:39.274382 [debug] [Thread-1 (]: Finished running node test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7
[0m14:00:39.275499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:39.275849 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m14:00:39.276110 [debug] [MainThread]: Connection 'test.lab2_pipeline.unique_stg_playstore_reviews_review_id.57d0adffb7' was properly closed.
[0m14:00:39.277823 [debug] [MainThread]: Command end result
[0m14:00:39.402598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m14:00:39.404715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m14:00:39.411023 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m14:00:39.413139 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:00:39.413414 [info ] [MainThread]: Building catalog
[0m14:00:39.423104 [debug] [ThreadPool]: Acquiring new duckdb connection 'google_play.information_schema'
[0m14:00:39.428121 [debug] [ThreadPool]: Using duckdb connection "google_play.information_schema"
[0m14:00:39.428423 [debug] [ThreadPool]: On google_play.information_schema: BEGIN
[0m14:00:39.428695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:39.429486 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:00:39.429765 [debug] [ThreadPool]: Using duckdb connection "google_play.information_schema"
[0m14:00:39.430069 [debug] [ThreadPool]: On google_play.information_schema: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "google_play.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'google_play'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'google_play'
    )
    select
        'google_play' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:00:39.436231 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:00:39.439284 [debug] [ThreadPool]: On google_play.information_schema: ROLLBACK
[0m14:00:39.439990 [debug] [ThreadPool]: Failed to rollback 'google_play.information_schema'
[0m14:00:39.440273 [debug] [ThreadPool]: On google_play.information_schema: Close
[0m14:00:39.452316 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\catalog.json
[0m14:00:39.475511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m14:00:39.477583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m14:00:39.478005 [info ] [MainThread]: Catalog written to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\catalog.json
[0m14:00:39.478987 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:00:39.478876 after 1.33 seconds
[0m14:00:39.479357 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:00:39.479908 [debug] [MainThread]: Connection 'google_play.information_schema' was properly closed.
[0m14:00:39.480631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BABE62150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BADEA28E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BADEA1F40>]}
[0m14:00:39.481141 [debug] [MainThread]: Flushing usage events
[0m14:00:40.278561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:54.096615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E97B84C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E98EB3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E98EB3C50>]}


============================== 14:00:54.100758 | d775112c-af4b-4aa7-b720-74f3363117eb ==============================
[0m14:00:54.100758 [info ] [MainThread]: Running with dbt=1.11.6
[0m14:00:54.101408 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs serve --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m14:00:54.336649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd775112c-af4b-4aa7-b720-74f3363117eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E981CDA70>]}
[0m14:00:54.406622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd775112c-af4b-4aa7-b720-74f3363117eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E98FBD9D0>]}
[0m14:45:06.323081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239CC64C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239DF97ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239DF97B10>]}


============================== 14:45:06.327224 | 75cceba6-482f-4bef-9b35-b5de8c6981a9 ==============================
[0m14:45:06.327224 [info ] [MainThread]: Running with dbt=1.11.6
[0m14:45:06.327859 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt snapshot --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\MSI\\Downloads\\Data-Enginering-main\\Data-Enginering-main\\lab2\\logs'}
[0m14:45:06.567535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239D2BDA70>]}
[0m14:45:06.642497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239E0A58C0>]}
[0m14:45:06.645188 [info ] [MainThread]: Registered adapter: duckdb=1.10.1
[0m14:45:06.892491 [debug] [MainThread]: checksum: ec27062d18352e9cfca161c166fcc73d2201661a23a3cf3c89196a27f32cfcb8, vars: {}, profile: , target: , version: 1.11.6
[0m14:45:07.049495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:07.049841 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:45:07.050091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:07.056024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_pipeline.marts
[0m14:45:07.102465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239E05B150>]}
[0m14:45:07.190767 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m14:45:07.192991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m14:45:07.213046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239F0FFE30>]}
[0m14:45:07.213493 [info ] [MainThread]: Found 3 models, 5 data tests, 1 snapshot, 588 macros
[0m14:45:07.214044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239F9018D0>]}
[0m14:45:07.215766 [info ] [MainThread]: 
[0m14:45:07.216223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:07.216652 [info ] [MainThread]: 
[0m14:45:07.217231 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:45:07.218184 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play'
[0m14:45:07.311122 [debug] [ThreadPool]: Using duckdb connection "list_google_play"
[0m14:45:07.311542 [debug] [ThreadPool]: On list_google_play: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"google_play"'
    
  
  
[0m14:45:07.311843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:07.328114 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:45:07.329426 [debug] [ThreadPool]: On list_google_play: Close
[0m14:45:07.330151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_google_play, now create_google_play_main)
[0m14:45:07.330590 [debug] [ThreadPool]: Creating schema "database: "google_play"
schema: "main"
"
[0m14:45:07.336380 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m14:45:07.336702 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='google_play'
        and type='sqlite'
    
  
[0m14:45:07.336990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:07.337931 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:07.339070 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m14:45:07.339375 [debug] [ThreadPool]: On create_google_play_main: BEGIN
[0m14:45:07.339873 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:07.340158 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m14:45:07.340439 [debug] [ThreadPool]: On create_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "create_google_play_main"} */

    
    
        create schema if not exists "google_play"."main"
    
[0m14:45:07.340951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:07.341713 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m14:45:07.342023 [debug] [ThreadPool]: Using duckdb connection "create_google_play_main"
[0m14:45:07.342304 [debug] [ThreadPool]: On create_google_play_main: COMMIT
[0m14:45:07.342756 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:45:07.343056 [debug] [ThreadPool]: On create_google_play_main: Close
[0m14:45:07.348354 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_google_play_main'
[0m14:45:07.397284 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m14:45:07.397652 [debug] [ThreadPool]: On list_google_play_main: BEGIN
[0m14:45:07.397934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:07.398609 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:45:07.398926 [debug] [ThreadPool]: Using duckdb connection "list_google_play_main"
[0m14:45:07.399243 [debug] [ThreadPool]: On list_google_play_main: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "connection_name": "list_google_play_main"} */
select
      'google_play' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'google_play'
  
[0m14:45:07.415154 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m14:45:07.416558 [debug] [ThreadPool]: On list_google_play_main: ROLLBACK
[0m14:45:07.417594 [debug] [ThreadPool]: Failed to rollback 'list_google_play_main'
[0m14:45:07.417930 [debug] [ThreadPool]: On list_google_play_main: Close
[0m14:45:07.419320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022399F3D980>]}
[0m14:45:07.419786 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.420088 [debug] [MainThread]: On master: BEGIN
[0m14:45:07.420362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:07.420950 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:07.421270 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.421564 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.421837 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.422297 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:07.422622 [debug] [MainThread]: On master: Close
[0m14:45:07.427113 [debug] [Thread-1 (]: Began running node snapshot.lab2_pipeline.apps_snapshot
[0m14:45:07.427659 [info ] [Thread-1 (]: 1 of 1 START snapshot main.apps_snapshot ....................................... [RUN]
[0m14:45:07.428366 [debug] [Thread-1 (]: Acquiring new duckdb connection 'snapshot.lab2_pipeline.apps_snapshot'
[0m14:45:07.428768 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_pipeline.apps_snapshot
[0m14:45:07.437052 [debug] [Thread-1 (]: Began executing node snapshot.lab2_pipeline.apps_snapshot
[0m14:45:07.499555 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.500091 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */
select * from (
        select rating from (
                

select * from "google_play"."main"."stg_playstore_apps"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m14:45:07.500512 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:07.506367 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:45:07.514726 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.515264 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: BEGIN
[0m14:45:07.516141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:45:07.516551 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.516965 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m14:45:07.520491 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:45:07.527899 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.528405 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m14:45:07.531242 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.580039 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.580569 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

        
  
    
    

    create  table
      "apps_snapshot__dbt_tmp20260222144507571368"
  
    as (
      
    
    with snapshot_query as (

        

select * from "google_play"."main"."stg_playstore_apps"

    ),

    snapshotted_data as (

        select *, 
    
        app_id as dbt_unique_key
    

        from "google_play"."main"."apps_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        app_id as dbt_unique_key
    
,
            now()::timestamp as dbt_updated_at,
            now()::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp, now()::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(app_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        app_id as dbt_unique_key
    
,
            now()::timestamp as dbt_updated_at,
            now()::timestamp as dbt_valid_from,
            now()::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."rating" != source_data."rating"
        or
        (
            ((snapshotted_data."rating" is null) and not (source_data."rating" is null))
            or
            ((not snapshotted_data."rating" is null) and (source_data."rating" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."rating" != source_data."rating"
        or
        (
            ((snapshotted_data."rating" is null) and not (source_data."rating" is null))
            or
            ((not snapshotted_data."rating" is null) and (source_data."rating" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    );
  
  
    
[0m14:45:07.597027 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:45:07.599662 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.600052 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot__dbt_tmp20260222144507571368'
      
      
      order by ordinal_position

  
[0m14:45:07.602636 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.605275 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.605642 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m14:45:07.608262 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.610815 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.611199 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot__dbt_tmp20260222144507571368'
      
      
      order by ordinal_position

  
[0m14:45:07.614354 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.617575 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.617972 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot'
      
      and lower(table_schema) = 'main'
      
      
      and lower(table_catalog) = 'google_play'
      
      order by ordinal_position

  
[0m14:45:07.620757 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.626754 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.627220 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'apps_snapshot__dbt_tmp20260222144507571368'
      
      
      order by ordinal_position

  
[0m14:45:07.629896 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:45:07.646063 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.646684 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */
DESCRIBE (select * from (
        
    
    with snapshot_query as (

        

select * from "google_play"."main"."stg_playstore_apps"

    ),

    snapshotted_data as (

        select *, 
    
        app_id as dbt_unique_key
    

        from "google_play"."main"."apps_snapshot"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        app_id as dbt_unique_key
    
,
            now()::timestamp as dbt_updated_at,
            now()::timestamp as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp, now()::timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(app_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        app_id as dbt_unique_key
    
,
            now()::timestamp as dbt_updated_at,
            now()::timestamp as dbt_valid_from,
            now()::timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."rating" != source_data."rating"
        or
        (
            ((snapshotted_data."rating" is null) and not (source_data."rating" is null))
            or
            ((not snapshotted_data."rating" is null) and (source_data."rating" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."rating" != source_data."rating"
        or
        (
            ((snapshotted_data."rating" is null) and not (source_data."rating" is null))
            or
            ((not snapshotted_data."rating" is null) and (source_data."rating" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:45:07.651927 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:45:07.655603 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.656061 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */
DESCRIBE (select * from (
        select now()::timestamp as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
)
[0m14:45:07.657044 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:45:07.657653 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.658719 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.659215 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      update "google_play"."main"."apps_snapshot" as DBT_INTERNAL_TARGET
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "apps_snapshot__dbt_tmp20260222144507571368" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = DBT_INTERNAL_TARGET.dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and DBT_INTERNAL_TARGET.dbt_valid_to is null;
      

    insert into "google_play"."main"."apps_snapshot" ("app_id", "app_name", "rating", "category", "developer_name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."app_id",DBT_INTERNAL_SOURCE."app_name",DBT_INTERNAL_SOURCE."rating",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."developer_name",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "apps_snapshot__dbt_tmp20260222144507571368" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;


  
[0m14:45:07.662771 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:45:07.673593 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: COMMIT
[0m14:45:07.674051 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.674598 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: COMMIT
[0m14:45:07.678513 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:45:07.684634 [debug] [Thread-1 (]: Using duckdb connection "snapshot.lab2_pipeline.apps_snapshot"
[0m14:45:07.685112 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: /* {"app": "dbt", "dbt_version": "1.11.6", "profile_name": "playstore_profile", "target_name": "dev", "node_id": "snapshot.lab2_pipeline.apps_snapshot"} */

      drop table if exists "apps_snapshot__dbt_tmp20260222144507571368" cascade
    
[0m14:45:07.688909 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:45:07.691467 [debug] [Thread-1 (]: On snapshot.lab2_pipeline.apps_snapshot: Close
[0m14:45:07.693387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75cceba6-482f-4bef-9b35-b5de8c6981a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239FAD3B90>]}
[0m14:45:07.694161 [info ] [Thread-1 (]: 1 of 1 OK snapshotted main.apps_snapshot ....................................... [[32mOK[0m in 0.26s]
[0m14:45:07.695048 [debug] [Thread-1 (]: Finished running node snapshot.lab2_pipeline.apps_snapshot
[0m14:45:07.696483 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.696832 [debug] [MainThread]: On master: BEGIN
[0m14:45:07.697118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:07.697717 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:45:07.698043 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.698332 [debug] [MainThread]: Using duckdb connection "master"
[0m14:45:07.698608 [debug] [MainThread]: On master: COMMIT
[0m14:45:07.699102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:45:07.699399 [debug] [MainThread]: On master: Close
[0m14:45:07.699762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:07.700040 [debug] [MainThread]: Connection 'create_google_play_main' was properly closed.
[0m14:45:07.700298 [debug] [MainThread]: Connection 'list_google_play_main' was properly closed.
[0m14:45:07.700552 [debug] [MainThread]: Connection 'snapshot.lab2_pipeline.apps_snapshot' was properly closed.
[0m14:45:07.700842 [info ] [MainThread]: 
[0m14:45:07.701324 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:45:07.702197 [debug] [MainThread]: Command end result
[0m14:45:07.727828 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\manifest.json
[0m14:45:07.730502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\semantic_manifest.json
[0m14:45:07.736734 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\MSI\Downloads\Data-Enginering-main\Data-Enginering-main\lab2\target\run_results.json
[0m14:45:07.737147 [info ] [MainThread]: 
[0m14:45:07.737689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:07.738212 [info ] [MainThread]: 
[0m14:45:07.738748 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:45:07.739718 [debug] [MainThread]: Command `dbt snapshot` succeeded at 14:45:07.739595 after 1.59 seconds
[0m14:45:07.740088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239FAED4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239FDA7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239FDA7ED0>]}
[0m14:45:07.740439 [debug] [MainThread]: Flushing usage events
[0m14:45:08.615296 [debug] [MainThread]: An error was encountered while trying to flush usage events
